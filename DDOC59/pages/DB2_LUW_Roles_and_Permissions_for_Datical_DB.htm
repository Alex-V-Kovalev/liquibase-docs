<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title></title>
    </head>
    <body>
        <h1>DB2 LUW Roles and Permissions for Datical DB</h1>
        <p />
        <div class="toc-macro client-side-toc-macro  conf-macro output-block">
        </div>
        <p>See <a href="Database_Users__Roles__and_Passwords.htm">Database Users, Roles, and Passwords</a> for a general discussion of database setup for Datical DB.&#160;</p>
        <h1 id="DB2LUWRolesandPermissionsforDaticalDB-Prerequisite">Prerequisite</h1>
        <p>DB2 managed databases should be configured for Oracle compatibility mode before you can use Datical's Stored Logic Validity Check. See <a class="external-link" href="https://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.apdv.porting.doc/doc/t0054729.html" rel="nofollow">IBM documentation</a>.&#160;<br /><br />$ su - db2inst1<br />$ db2start<br />$ db2set DB2_COMPATIBILITY_VECTOR=ORA<br />$ db2set DB2_DEFERRED_PREPARE_SEMANTICS=YES<br />$ db2stop<br />$ db2start</p>
        <h1 id="DB2LUWRolesandPermissionsforDaticalDB-Role-BasedPrivilegesforServiceUser">Role-Based Privileges for Service User</h1>
        <p>Datical DB does not require special privileges above and beyond what is required to create, alter, and drop the most common database object types that support your database applications. There are two common implementation patterns for configuring Datical DB access schemes in DB2: granting privileges to the Datical Role and granting privileges to a single Datical User.</p>
        <h2 id="DB2LUWRolesandPermissionsforDaticalDB-GrantingPrivilegestoaDaticalRole">Granting Privileges to a Datical Role</h2>
        <p>Granting privileges to a Datical Role is typically chosen in environments where individual team members will use unique credentials to access the database through Datical DB.&#160; This simplifies the privilege management process by centralizing where GRANTS &amp; REVOKES are performed.&#160; The role is then assigned to the user accounts that require database access with Datical DB.</p>
        <h2 id="DB2LUWRolesandPermissionsforDaticalDB-GrantingPrivilegestoaDedicatedDaticalDBUser(ServiceUser)">Granting Privileges to a Dedicated Datical DBUser (Service User)</h2>
        <p>Granting privileges to a dedicated Datical User allows an organization to drastically reduce the number of individuals with access to the database password.&#160; Because the database password is encoded in Datical DB, an administrator may create Datical DB projects and share them with Datical DB users.&#160; The Datical DB users can then perform database change tasks without having access to the database password.</p>
        <h1 id="DB2LUWRolesandPermissionsforDaticalDB-PrivilegesforManagedDatabases">Privileges for Managed Databases</h1>
        <p>To validate and automate database deployments Datical DB needs to be able to connect to a database and to perform routine CREATE, ALTER, &amp; DROP statements in the appropriate schema.</p>
        <p>
            <br />
        </p>
        <ul>
            <li><strong>Database Privileges</strong>
                <ul>
                    <li>CONNECT<ul><li>Grants the authority to access the database.</li></ul></li>
                </ul>
            </li>
            <li><strong>Schema Privileges&#160;</strong><em>(use “<strong>with grant option</strong>” if user/role needs to grant permissions to other users/roles)</em>
            </li>
        </ul>
        <ul>
            <li style="list-style-type: none;background-image: none;">
                <ul>
                    <li>CREATEIN<ul><li>Grants the privilege to create objects in the schema. Other authorities or privileges required to create the object (such as CREATETAB) are still required. The owner of an explicitly created schema automatically receives CREATEIN privilege. An implicitly created schema has CREATEIN privilege automatically granted to PUBLIC.</li></ul></li>
                    <li>ALTERIN<ul><li>Grants the privilege to alter or comment on all objects in the schema. The owner of an explicitly created schema automatically receives ALTERIN privilege.</li></ul></li>
                    <li>DROPIN<ul><li>Grants the privilege to drop all objects in the schema. The owner of an explicitly created schema automatically receives DROPIN privilege.</li></ul></li>
                    <li>WITH GRANT OPTION (so the user can grant permissions to other users/roles)<ul style="margin-left: 0.0px;"><li>Allows the specified&#160;<em>authorization-name</em>s to GRANT privileges to others.<ul style="margin-left: 0.0px;"><li>Schema level CREATEIN, ALTERIN, DROPIN With Grant Option must be granted to the user for the schema. This will ensure the user has the privilege to grant permissions for any <strong>newly created objects</strong>.</li><li><strong>To manage permissions for existing objects</strong>, the following privileges must be granted (<a class="external-link" href="https://www.ibm.com/support/knowledgecenter/en/SSEPGG_9.5.0/com.ibm.db2.luw.sql.ref.doc/doc/r0000966.html" rel="nofollow">https://www.ibm.com/support/knowledgecenter/en/SSEPGG_9.5.0/com.ibm.db2.luw.sql.ref.doc/doc/r0000966.html</a>)<ul><li>Object level CREATEIN, ALTERIN, DROPIN With Grant Option&#160;must be granted to the user for the appropriate objects on the database, or</li><li><div>Object level CONTROL privilege must be granted to the user for the appropriate objects on the database</div></li></ul></li></ul></li></ul></li>
                </ul>
            </li>
            <li><strong>Data Privileges</strong>
                <ul>
                    <li>DATAACCESS (<a class="external-link" href="https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.admin.sec.doc/doc/c0053934.html" rel="nofollow">https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.admin.sec.doc/doc/c0053934.html</a>)<ul><li>Access and update data in user tables, views, and materialized query tables in a DB2 subsystem</li><li>Execute plans, packages, functions, and procedures.</li><li>Select privilege on all system catalog tables and views.</li></ul></li>
                </ul>
            </li>
            <li><strong>Tablespace Access</strong>
                <ul>
                    <li>GRANT USE OF TABLESPACE &lt;tablespace_name&gt; TO ROLE &lt;role_name&gt;<ul><li>Provides access to the desired tablespace&#160;</li></ul></li>
                </ul>
            </li>
        </ul>
        <h1 id="DB2LUWRolesandPermissionsforDaticalDB-PrivilegesfortheREFDatabase">Privileges for the REF Database</h1>
        <p>You must have SYSADM, SYSCTRL, or SYSMAINT authority to use the backup utility which is required by the Datical Packager.</p>
        <p>This permission is only needed on user accounts involved in packaging changes in the REF databases. It is not needed in any of the other databases in the environment.</p>
        <h1 id="DB2LUWRolesandPermissionsforDaticalDB-PermissionsneededtoperformGRANTS">Permissions needed to perform GRANTS</h1>
        <p>To perform grants - if you don't use the "WITH GRANT OPTIONS" on CREATEIN/ALTERIN/DROPIN or grant CONTROL, you will also need to grant&#160;<span style="color: rgb(0,0,0);">ACCESSCTRL as documented in&#160;<a class="external-link" href="https://www.ibm.com/support/knowledgecenter/en/SSEPGG_10.1.0/com.ibm.db2.luw.admin.sec.doc/doc/c0053933.html" rel="nofollow">https://www.ibm.com/support/knowledgecenter/en/SSEPGG_10.1.0/com.ibm.db2.luw.admin.sec.doc/doc/c0053933.html</a>.</span></p>
        <h1 id="DB2LUWRolesandPermissionsforDaticalDB-Example:CreatingaRoletoContainPrivileges">Example: Creating a Role to Contain Privileges</h1>
        <p>In the following example you create the DATDB_ROLE, and grant privileges to it, then grant the DATDB_ROLE to user DATDB_USER.&#160;</p>
        <p>
            <br />
        </p>
        <div class="code panel pdl conf-macro output-block" style="border-width: 1px;">
            <div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">-- Create the role ‘DATDB_ROLE’ and grant the ‘CONNECT’ privilege for the DB to be managed
CREATE ROLE DATDB_ROLE
GRANT CONNECT ON DATABASE TO ROLE DATDB_ROLE
 
-- Grant ‘ALTERIN’,’CREATEIN’ &amp; ‘DROPIN’ privileges to ‘DATDB_ROLE’ for the desired schema
--
-- “with grant option” can be optionally added to the following statements if the role needs
-- to grant permissions to other users/roles
GRANT ALTERIN ON SCHEMA MYAPPSCHEMA TO ROLE DATDB_ROLE WITH GRANT OPTION
GRANT CREATEIN ON SCHEMA MYAPPSCHEMA TO ROLE DATDB_ROLE WITH GRANT OPTION
GRANT DROPIN ON SCHEMA MYAPPSCHEMA TO ROLE DATDB_ROLE WITH GRANT OPTION

-- To be able to grant permissions to existing objects, you will need to either
--   Provide object level CREATEIN, ALTERIN, DROPIN With Grant Option privileges, or
--   Provide object level CONTROL privilege
-- to the DATDB_ROLE
GRANT ALTERIN, CREATEIN, DROPIN ON TABLE1 TO ROLE DATDB_ROLE WITH GRANT OPTION
--GRANT CONTROL ON TABLE1 TO ROLE DATDB_ROLE WITH GRANT OPTION

-- Grant data access on a database to a specific role
GRANT DATAACCESS ON DATABASE TO ROLE DATDB_ROLE
 
-- Grant tablespace access to role
GRANT USE OF TABLESPACE &lt;tablespace_name&gt; TO ROLE DATDB_ROLE
 
-- Grant the role ‘DATDB_ROLE’ to user ‘DATDB_USER’
GRANT ROLE DATDB_ROLE TO USER DATDB_USER</pre>
            </div>
        </div>
        <h1 id="DB2LUWRolesandPermissionsforDaticalDB-Example:GrantingPrivilegesDirectlytoaUser">Example: Granting Privileges Directly to a User</h1>
        <p>In this example you create user DATDB_USER and grant privileges directly to the user.&#160;</p>
        <div class="code panel pdl conf-macro output-block" style="border-width: 1px;">
            <div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">-- Grant the ‘CONNECT’ privilege for the DB to be managed
GRANT CONNECT ON DATABASE TO USER DATDB_USER
 
-- Grant ‘ALTERIN’,’CREATEIN’ &amp; ‘DROPIN’ privileges to ‘DATDB_ROLE’ for the desired schema
--
-- “with grant option” can be optionally added to the following statements if the user needs
-- to grant permissions to other users/roles
GRANT ALTERIN ON SCHEMA MYAPPSCHEMA TO USER DATDB_USER WITH GRANT OPTION
GRANT CREATEIN ON SCHEMA MYAPPSCHEMA TO USER DATDB_USER WITH GRANT OPTION
GRANT DROPIN ON SCHEMA MYAPPSCHEMA TO USER DATDB_USER WITH GRANT OPTION

-- To be able to grant permissions to existing objects, you will need to either
--   Provide object level CREATEIN, ALTERIN, DROPIN With Grant Option privileges, or
--   Provide object level CONTROL privilege
-- to the DATDB_USER
GRANT ALTERIN, CREATEIN, DROPIN ON TABLE1 TO ROLE DATDB_USER WITH GRANT OPTION
--GRANT CONTROL ON TABLE1 TO ROLE DATDB_USER WITH GRANT OPTION

-- Grant data access on a database to a specific role
GRANT DATAACCESS ON DATABASE TO USER DATDB_USER
 
-- Grant tablespace access to role
GRANT USE OF TABLESPACE &lt;tablespace_name&gt; TO USER DATDB_USER</pre>
            </div>
        </div>
        <h1 id="DB2LUWRolesandPermissionsforDaticalDB-Example:ViewingUserPermissions">Example: Viewing User Permissions</h1>
        <p>The following example shows two ways to view privileges for user DATDB_USER.&#160;</p>
        <div class="code panel pdl conf-macro output-block" style="border-width: 1px;">
            <div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">-- Retrieve database permissions for user DATDB_USER
select * from SYSCAT.DBAUTH  where GRANTEE = 'DATDB_USER'

-- Retrieve privilege granted to DATDB_USER along with the object name, schema, and type
SELECT * FROM SYSIBMADM.PRIVILEGES WHERE AUTHIDTYPE = 'U' AND AUTHID = 'DATDB_USER'</pre>
            </div>
        </div>
    </body>
</html>