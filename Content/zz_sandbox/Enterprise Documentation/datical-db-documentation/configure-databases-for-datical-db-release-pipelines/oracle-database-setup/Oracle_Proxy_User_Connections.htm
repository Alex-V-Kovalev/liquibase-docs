<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title></title>
    </head>
    <body>
        <h1>Oracle Proxy User Connections</h1>
        <div class="toc-macro client-side-toc-macro  conf-macro output-block">
        </div>
        <h1 id="OracleProxyUserConnections-Proxyuserconnection">Proxy user connection</h1>
        <p>A proxy connection allows you to connect to a database as one user account and operate with the access and privileges of a different account.<br />It is typically used to share one database account that has required privileges to other database users without sharing its password. An example of this type of account sharing means that you can allow help desk support personnel to connect to the database using a "helpdesk" account that has correct roles and privileges without sharing the password for this account with them.<br />There are two terms you need to know when setting up the proxy connection<span style="color: rgb(23,23,23);">—</span>proxy user and client user.</p>
        <ul>
            <li>
                <p><strong>A</strong>  <strong>proxy user</strong> is a user who connects to the database on behalf of another user. This user connects with the username and password set up for him without knowing the client user password.</p>
            </li>
            <li>
                <p><strong>A client user</strong> is a user on behalf of whom the proxy user connects.</p>
            </li>
        </ul>
        <p>Let's imagine that you connect to the database as the owner and want your employee who has limited privileges to work with the same schemas and database links. Instead of granting all the permissions one by one, you can set up a proxy connection. <br />In this way, your employee signs into the database under your account with his credentials or by specifying the properties that depend on the connection type.<br />In this topic, we will discuss the following types:</p>
        <ul>
            <li>
                <p>Basic and proxy connection</p>
            </li>
            <li>
                <p>TNS/LDAP and proxy connection</p>
            </li>
            <li>
                <p>Kerberos and proxy connection</p>
            </li>
        </ul>
        <h2 id="OracleProxyUserConnections-SettingupaproxyconnectionwithBASICandTNS/LDAP">Setting up a proxy connection with BASIC and TNS/LDAP</h2>
        <p>Before setting up any proxy connection, you need to have two users:</p>
        <ul>
            <li>
                <p><strong>The proxy</strong>  <strong>user</strong> - the user that will initiate the connection under the proxy client user account.</p>
            </li>
            <li>
                <p><strong>The</strong>  <strong>proxy</strong>  <strong>client</strong>  <strong>user</strong> - the user whose privileges, schema, and objects will be available for the session.</p>
            </li>
        </ul>
        <p><span class="confluence-anchor-link conf-macro output-inline" id="OracleProxyUserConnections-_Hlk41561953"></span>To set up a proxy connection with <strong>BASIC</strong> and <strong>TNS/LDAP</strong>, enter the following at the command prompt or terminal but mention your information:</p>
        <ol>
            <li>
                <p><code>create user proxyuser_test identified by proxypassword</code>&#160;to create a database user account<span class="confluence-anchor-link conf-macro output-inline" id="OracleProxyUserConnections-_Hlk41552211"></span></p>
            </li>
            <li>
                <p><code>grant create session to proxyuser_test</code>&#160;to grant the permissions to create session</p>
            </li>
            <li>
                <p><code>alter user daticaltest grant connect through proxyuser_test</code>&#160;to enable the client user, which is <span style="color: rgb(192,0,0);">daticaltest</span> account, to connect to the database using the proxy account.</p>
            </li>
        </ol>
        <h2 id="OracleProxyUserConnections-SettingupaproxyconnectionwithKerberos">Setting up a proxy connection with Kerberos</h2>
        <p>As an authentication method, Kerberos is handled by a different mechanism. To set up a proxy connection with Kerberos, you need to connect to your database and get an authentication ticket first. Pay attention to the expiration date and of the ticket and whether it is valid.<br />Also, make sure that one of the following environment variables is set—<strong>DDB_KRB5_CONFIG</strong> or <strong>KRB5_CONFIG</strong>. They contain Kerberos configuration information and indicate the location.<br />Here is the example of connecting to an Oracle database and getting a Kerberos ticket: Create the <strong>tnsnames.ora</strong> file</p>
        <h3 id="OracleProxyUserConnections-1.Example'tnsnames.ora'file">1.&#160;Example 'tnsnames.ora' file</h3>
        <div class="code panel pdl conf-macro output-block" style="border-width: 1px;">
            <div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">KRB=
(DESCRIPTION =
  (ADDRESS =
    (PROTOCOL = TCP)
    (HOST = oracle-ee-kerberos.example.us-east-1.rds.amazonaws.com)
    (PORT = 1521))
  (CONNECT_DATA =
    (SERVER = DEDICATED)
    (SERVICE_NAME = KRB)
  )
)</pre>
            </div>
        </div>
        <p>
            <br />
        </p>
        <h3 id="OracleProxyUserConnections-2.Examplesqlnet.orafile">2.&#160;Example&#160;<strong>sqlnet.ora</strong> file</h3>
        <div class="code panel pdl conf-macro output-block" style="border-width: 1px;">
            <div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">SQLNET.KERBEROS5_CC_NAME=/tmp/kerbache
SQLNET.AUTHENTICATION_SERVICES=(KERBEROS5PRE,KERBEROS5)
SQLNET.KERBEROS5_CONF=/tmp/kerberos/krb5.conf
TRACE_LEVEL_CLIENT=16
SQLNET.KERBEROS5_CONF_MIT = TRUE
NAMES.DIRECTORY_PATH=(TNSNAMES)</pre>
            </div>
        </div>
        <p><em><strong><span style="color: rgb(127,127,127);">NOTE:&#160;</span></strong><span style="color: rgb(127,127,127);">WINDOWS use following services in sqlnet.ora: SQLNET.AUTHENTICATION_SERVICES=(BEQ,KERBEROS5)</span></em>
        </p>
        <h3 id="OracleProxyUserConnections-3.Examplekrb5.conffile">3. Example&#160;<strong>krb5.conf</strong> file</h3>
        <div class="code panel pdl conf-macro output-block" style="border-width: 1px;">
            <div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">[libdefaults]
default_realm = TEST.DATICAL.NET
default_ccache_name = /tmp/kerbcache
[realms]
TEST.DATICAL.NET = {
kdc = test.datical.net
admin_server = test.datical.net
}
[domain_realm]
.test.datical.net = TEST.DATICAL.NET
test.datical.net = TEST.DATICAL.NET</pre>
            </div>
        </div>
        <h3 id="OracleProxyUserConnections-4.GetaKerberosauthenticationticket">4. Get a Kerberos authentication ticket</h3>
        <div class="code panel pdl conf-macro output-block" style="border-width: 1px;">
            <div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">kinit &lt;ADusername&gt;@TEST.DATICAL.NET
example: kinit jnew@TEST.DATICAL.NET</pre>
            </div>
        </div>
        <p><em><strong><span style="color: rgb(127,127,127);">NOTE:&#160;</span></strong><span style="color: rgb(127,127,127);">For dblinks, you will need forwardable ticket, so use</span></em>  <em><span style="color: rgb(192,0,0);">kinit -f</span></em>  <em><span style="color: rgb(127,127,127);">instead.</span></em></p>
        <h3 id="OracleProxyUserConnections-5.SetupaproxyconnectionwithKerberos">
            <br />5. Set up a proxy connection with Kerberos</h3>
        <p>Add the AD user to the database by first connecting as the client user. Enter the following in your command prompt or terminal by putting your information:</p>
        <div class="code panel pdl conf-macro output-block" style="border-width: 1px;">
            <div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">CREATE USER "JNEW@TEST.DATICAL.NET" IDENTIFIED EXTERNALLY; 
GRANT CREATE SESSION TO "JNEW@ADTEST.DATICAL.NET";</pre>
            </div>
        </div>
        <p>
            <br />
        </p>
        <h2 id="OracleProxyUserConnections-Usingproxyconnection">Using proxy connection</h2>
        <p>There are four options you can choose to connect to your database:</p>
        <ul>
            <li>
                <p>BASIC proxy connection</p>
            </li>
            <li>
                <p>BASIC and Kerberos proxy connection</p>
            </li>
            <li>
                <p>TNS/LDAP proxy connection</p>
            </li>
            <li>
                <p>TNS/LDAP and Kerberos proxy connection</p>
            </li>
        </ul>
        <p>The following table provides the format of credentials for each authentication method.</p>
        <div class="table-wrap">
            <table class="confluenceTable">
                <colgroup>
                    <col style="width: 93.0px;" />
                    <col style="width: 251.0px;" />
                    <col style="width: 251.0px;" />
                    <col style="width: 163.0px;" />
                </colgroup>
                <tbody>
                    <tr>
                        <td class="confluenceTd">
                            <p>
                                <br />
                            </p>
                        </td>
                        <td class="confluenceTd">
                            <p><strong>BASIC</strong>
                            </p>
                        </td>
                        <td class="confluenceTd">
                            <p><strong>TNS/LDAP</strong>
                            </p>
                        </td>
                        <td class="confluenceTd">
                            <p><strong>Kerberos</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td class="confluenceTd">
                            <p>Username</p>
                        </td>
                        <td class="confluenceTd">
                            <p>proxy_user[proxy_client_user]</p>
                        </td>
                        <td class="confluenceTd">
                            <p>proxy_user[proxy_client_user]</p>
                        </td>
                        <td class="confluenceTd">
                            <p>[proxy_client_user]</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="confluenceTd">
                            <p>Password</p>
                        </td>
                        <td class="confluenceTd">
                            <p>proxypass</p>
                        </td>
                        <td class="confluenceTd">
                            <p>proxypass</p>
                        </td>
                        <td class="confluenceTd">
                            <p>&lt;none&gt;</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p>
            <br />Here is the example of one of the ways to connect to your database:<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="317" width="293" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/1581285378/worddav3542abb7a6b0267a3a1a0afe76a5900c.png?version=1&amp;modificationDate=1597853598481&amp;cacheVersion=1&amp;api=v2&amp;width=293&amp;height=317" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/1581285378/worddav3542abb7a6b0267a3a1a0afe76a5900c.png?version=1&amp;modificationDate=1597853598481&amp;cacheVersion=1&amp;api=v2&amp;width=586&amp;height=634 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/1581285378/worddav3542abb7a6b0267a3a1a0afe76a5900c.png?version=1&amp;modificationDate=1597853598481&amp;cacheVersion=1&amp;api=v2&amp;width=293&amp;height=317 1x" /></span><br />By selecting Kerberos, you don't have to specify the proxy_user [proxy_client_user] format and can just enter [proxy_client_user]. If you clear the check box for <strong>Kerberos</strong>, you have to specify the username and password, so it takes the form proxy_user [proxy_client_user].</p>
    </body>
</html>