<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body>
        <h1 id="liquibase-commands-snapshot"><code>snapshot</code> command</h1>
        <p>The <code class="highlighter-rouge">snapshot</code> command has two modes. When run without options, it will gather the current state of the database and show a text-based version of the schema to <code>STDOUT</code>. When
run with the <code class="highlighter-rouge">--snapshotFormat=JSON</code> option, creates a JSON file that represents the current state of your database. A snapshot is like a photograph of your database that
can be used in the <MadCap:xref href="diff.htm">diff command</MadCap:xref> or <MadCap:xref href="diffChangeLog.html"> diffChangeLog command</MadCap:xref>.</p>
        <h2 id="uses">Uses</h2>
        <p>The <code class="highlighter-rouge">snapshot</code> command is typically used when you want to quickly compare changes in your database or keep a record of your current database state. Snapshots can also be used to compare:</p>
        <ul>
            <li>A previous database state to an online database.</li>
            <li>A previous database state to another snapshot. </li>
        </ul>
        <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">Running a <code class="highlighter-rouge">diff</code> command using at least one <em>snapshot.json</em> file is faster than using a <code class="highlighter-rouge">diff</code> command with two online databases. However, keep in mind that a snapshot will no
longer reflect the current state of the database if the database is changed with the <code class="highlighter-rouge">update</code> command or if it is changed manually.</p>
        <h2 id="running-the-snapshot-command">Running the <code>snapshot</code> command</h2>
        <p>To take a snapshot of your database:</p>
        <ol>
            <li>Configure the <em><MadCap:variable name="General.liquiPropFile" /></em> file to include your driver class path, URL, and user authentication information for your database.
    <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">For information on how to configure your <em><MadCap:variable name="General.liquiPropFile" /></em> file, view the <MadCap:xref href="../../workflows/liquibase-community/creating-config-properties.html">Creating and configuring a [%=General.liquiPropFile%] file</MadCap:xref> topic in the knowledge base.</p></li>
            <li>Run the following command: <code class="highlighter-rouge">liquibase --outputFile=myschemaSnapshot.json snapshot --snapshotFormat=json</code></li>
        </ol>
        <h2 id="using-the-snapshot-in-the-diff-and-diffchangelog-commands">Using the snapshot in the diff and <code>diffChangeLog</code> commands</h2>
        <p>You can use the JSON format snapshot file in the diff and <code>diffChangeLog</code> commands. One typical workflow is:</p>
        <ol>
            <li>Make sure your local environment is up-to-date by getting the latest <MadCap:variable name="General.changelog" style="font-style: italic;" /> from source control.</li>
            <li>Configure your <em><MadCap:variable name="General.liquiPropFile" /></em> to point to a local development database and run <code class="highlighter-rouge">liquibase update</code> to ensure it has the latest schema.</li>
            <li>Take a snapshot of the local development database with <code class="highlighter-rouge">liquibase --outputFile=before.json snapshot --snapshotFormat=json</code></li>
            <li>Make manual changes to the local development database as needed.</li>
            <li>Add the manual changes to the <MadCap:variable name="General.changelog" style="font-style: italic;" /> with <code class="highlighter-rouge">liquibase --url=jdbc:oracle:thin://localhost:9090/mem:test --referenceUrl=offline:mysql?snapshot=before.json diffChangeLog</code>.</li>
            <li>Review the <MadCap:variable name="General.changelog" style="font-style: italic;" /> to ensure that it matches your expectations of the manual changes made.</li>
            <li>Mark the manual changes as deployed in the local development database by running <code class="highlighter-rouge">liquibase changeLogSync</code>.</li>
            <li>Commit the changes to source control.</li>
        </ol>
        <p>The format for the database URL when using a snapshot is:</p>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bash" data-lang="bash">offline:&lt;dbtype&gt;?snapshot<span class="o">=</span>&lt;path/to/snapshot.json&gt;</code></pre>
        </figure>
        <p>The <code class="highlighter-rouge">&lt;dbtype&gt;</code> in that URL should be the Type Name from the list of <a href="https://www.liquibase.org/get-started/databases">supported databases</a>, and the <code class="highlighter-rouge">&lt;path/to/snapshot.json&gt;</code> is a path relative to where the command is running.</p>
        <h2 id="output">Output</h2>
        <details>
            <summary style="font-size: 125%;color: blue;">myschemaSnapshot.json example</summary>
            <br />
            <figure class="highlight"><pre xml:space="preserve"><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">  </span><span class="s2">"snapshot"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"created"</span><span class="p">:</span><span class="w">  </span><span class="s2">"2019-10-23T16:10:40.306"</span><span class="p">,</span><span class="w">  </span><span class="s2">"database"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"productVersion"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production</span><span class="se">\n</span><span class="s2">With the Partitioning option"</span><span class="p">,</span><span class="w">  </span><span class="s2">"shortName"</span><span class="p">:</span><span class="w">  </span><span class="s2">"oracle"</span><span class="p">,</span><span class="w">  </span><span class="s2">"majorVersion"</span><span class="p">:</span><span class="w">  </span><span class="s2">"11"</span><span class="p">,</span><span class="w">  </span><span class="s2">"minorVersion"</span><span class="p">:</span><span class="w">  </span><span class="s2">"2"</span><span class="p">,</span><span class="w">  </span><span class="s2">"user"</span><span class="p">:</span><span class="w">  </span><span class="s2">"MYSCHEMA"</span><span class="p">,</span><span class="w">  </span><span class="s2">"productName"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Oracle"</span><span class="p">,</span><span class="w">  </span><span class="s2">"url"</span><span class="p">:</span><span class="w">  </span><span class="s2">"jdbc:oracle:thin:@localhost:1521:ORCL"</span><span class="w">  </span><span class="p">},</span><span class="w">  </span><span class="s2">"objects"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.appdba.synonym.Synonym"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"synonym"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"PRIVATETABLESYN"</span><span class="p">,</span><span class="w">  </span><span class="s2">"objectName"</span><span class="p">:</span><span class="w">  </span><span class="s2">"PRIMARY_TABLE"</span><span class="p">,</span><span class="w">  </span><span class="s2">"objectSchema"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Schema#b689101"</span><span class="p">,</span><span class="w">  </span><span class="s2">"private"</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="s2">"schema"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Schema#b689101"</span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"b689152"</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Catalog"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"catalog"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"default"</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="s2">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"MYSCHEMA"</span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"b689100"</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"column"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"defaultValue"</span><span class="p">:</span><span class="w">  </span><span class="s2">"1!{java.math.BigDecimal}"</span><span class="p">,</span><span class="w">  </span><span class="s2">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"ACTIVE"</span><span class="p">,</span><span class="w">  </span><span class="s2">"nullable"</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="s2">"order"</span><span class="p">:</span><span class="w">  </span><span class="s2">"3!{java.lang.Integer}"</span><span class="p">,</span><span class="w">  </span><span class="s2">"relation"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Table#b689129"</span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"b689133"</span><span class="p">,</span><span class="w">  </span><span class="s2">"type"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"columnSize"</span><span class="p">:</span><span class="w">  </span><span class="s2">"1!{java.lang.Integer}"</span><span class="p">,</span><span class="w">  </span><span class="s2">"dataTypeId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"3!{java.lang.Integer}"</span><span class="p">,</span><span class="w">  </span><span class="s2">"decimalDigits"</span><span class="p">:</span><span class="w">  </span><span class="s2">"0!{java.lang.Integer}"</span><span class="p">,</span><span class="w">  </span><span class="s2">"typeName"</span><span class="p">:</span><span class="w">  </span><span class="s2">"NUMBER"</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Index"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"index"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"columns"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689137"</span><span class="p">]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"PK_DATABASECHANGELOGLOCK"</span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"b689136"</span><span class="p">,</span><span class="w">  </span><span class="s2">"table"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Table#b689135"</span><span class="p">,</span><span class="w">  </span><span class="s2">"unique"</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.PrimaryKey"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"primaryKey"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"backingIndex"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Index#b689136"</span><span class="p">,</span><span class="w">  </span><span class="s2">"columns"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689137"</span><span class="p">]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"PK_DATABASECHANGELOGLOCK"</span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"b689141"</span><span class="p">,</span><span class="w">  </span><span class="s2">"table"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Table#b689135"</span><span class="p">,</span><span class="w">  </span><span class="s2">"validate"</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Schema"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"schema"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"catalog"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Catalog#b689100"</span><span class="p">,</span><span class="w">  </span><span class="s2">"default"</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="s2">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"MYSCHEMA"</span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"b689101"</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Table"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"table"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"columns"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689109"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689110"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689111"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689112"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689113"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689114"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689115"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689116"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689117"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689118"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689119"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689120"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689121"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689122"</span><span class="p">]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"DATABASECHANGELOG"</span><span class="p">,</span><span class="w">  </span><span class="s2">"schema"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Schema#b689101"</span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"b689108"</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.View"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"view"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"columns"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689149"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689150"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column#b689151"</span><span class="p">]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"definition"</span><span class="p">:</span><span class="w">  </span><span class="s2">"SELECT </span><span class="se">\"</span><span class="s2">ID</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">NAME</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">ACTIVE</span><span class="se">\"\n</span><span class="s2">  </span><span class="se">\n</span><span class="s2">FROM </span><span class="se">\"</span><span class="s2">MYSCHEMA</span><span class="se">\"</span><span class="s2">.</span><span class="se">\"</span><span class="s2">DEPARTMENT</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span><span class="w">  </span><span class="s2">"editioning"</span><span class="p">:</span><span class="w">  </span><span class="kc">false</span><span class="p">,</span><span class="w">  </span><span class="s2">"name"</span><span class="p">:</span><span class="w">  </span><span class="s2">"VIEW1"</span><span class="p">,</span><span class="w">  </span><span class="s2">"schema"</span><span class="p">:</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Schema#b689101"</span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotId"</span><span class="p">:</span><span class="w">  </span><span class="s2">"b689148"</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}]</span><span class="w">  </span><span class="p">,</span><span class="w">  </span><span class="s2">"snapshotControl"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"snapshotControl"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">  </span><span class="s2">"includedType"</span><span class="p">:</span><span class="w">  </span><span class="p">[</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.appdba.synonym.Synonym"</span><span class="p">,</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.storedlogic.checkconstraint.CheckConstraint"</span><span class="p">,</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.storedlogic.databasepackage.DatabasePackage"</span><span class="p">,</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.storedlogic.databasepackage.DatabasePackageBody"</span><span class="p">,</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.storedlogic.function.Function"</span><span class="p">,</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.storedlogic.javalogic.JavaClass"</span><span class="p">,</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.storedlogic.javalogic.JavaSource"</span><span class="p">,</span><span class="w">  </span><span class="s2">"com.datical.liquibase.ext.storedlogic.trigger.Trigger"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Catalog"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Column"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.ForeignKey"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Index"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.PrimaryKey"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Schema"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Sequence"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.StoredProcedure"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.Table"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.UniqueConstraint"</span><span class="p">,</span><span class="w">  </span><span class="s2">"liquibase.structure.core.View"</span><span class="p">]</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}</span><span class="w">  </span><span class="p">}</span></code></pre>
            </figure>
        </details>
        <p>The <code class="highlighter-rouge">snapshot</code> command produces a JSON file that contains all your objects and places the file in the same directory as your <em><MadCap:variable name="General.changelog" /></em>.</p>
        <p><MadCap:variable name="General.LBCommunity" /> <code class="highlighter-rouge">snapshot</code> categories:</p>
        <ul>
            <li>Catalog</li>
            <li>Column</li>
            <li>Foreign Key</li>
            <li>Index</li>
            <li>Primary Key</li>
            <li>Schema</li>
            <li>Sequence</li>
            <li>Unique Constraints</li>
            <li>View</li>
        </ul>
        <p><MadCap:variable name="General.LBPro" /> <code class="highlighter-rouge">snapshot</code> categories:</p>
        <ul>
            <li>Package</li>
            <li>Package Body</li>
            <li>Procedures</li>
            <li>Function</li>
            <li>Trigger</li>
            <li>Synonyms</li>
            <li>Check Constraints</li>
        </ul>
    </body>
</html>