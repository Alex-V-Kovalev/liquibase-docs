<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Z_Resources/Stylesheets/TableStyles.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>checks-scope</title>
        <meta rel="canonical" href="https://docs.liquibase.com/commands/quality-checks/checks-scope.html" />
        <meta name="description" content="Reference information and use cases for the check-scope command. The checks-scope is a parameter that can be applied to the checks run command which allows the user to check either the changelog or database against any enabled checks." />
    </head>
    <body>
        <h1 id="liquibase-commands-diff-changelog"><code>checks-scope</code>
        </h1>
        <img src="../../Z_Resources/Images/Logos/pro-pages.jpg" style="vertical-align: middle;width: 3%;" />
        <p>The checks-scope is a parameter that can be applied to the checks run command which allows the user to check either the changelog or database against any enabled checks.</p>
        <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">This command is only available with <b><MadCap:variable name="General.Liquibase Empire" />.</b></p>
        <h2 id="uses">Uses</h2>
        <p>When <code>--checks-scope changelog</code> is ran, Liquibase checks each changeset in a changelog to see if any of those changesets trigger any enabled checks. When <code>--checks-scope database</code> is ran, Liquibase checks each database object to see if any of those objects trigger any enabled checks.  Both the changelog and database can be checked by themselves or at the same time. Users may choose between <code>changelog</code>, <code>database</code>, or <code>database, changelog</code> to run the enabled checks against. If <code>--checks-scope</code> is not specified, Liquibase defaults to running <MadCap:variable name="General.changelog" /> checks.</p>
        <h3>An example of running the <code>checks-scope</code> parameter</h3><pre xml:space="preserve"><code class="language-text">liquibase checks run --checks-scope changelog --changelog-file &lt;example-changelog.xml&gt;</code></pre>
        <h2>Running the checks-scope command</h2>
        <p>A check can be one scope or dual-scoped. When executed, the command can be used in any of the following ways:</p>
        <p>&#160;</p><code><p>liquibase --checks-scope=<MadCap:variable name="General.changelog" /></p><p>liquibase --checks-scope=database </p><p>liquibase --checks-scope=changelog, database</p><p>liquibase --checks-scope=database, changelog</p> </code>
        <h2>checks-scope Parameter Attributes</h2>
        <p>The following table identifies attributes that can be used with the <code>checks-scope</code> parameter. Please be aware that <code>checks-scope</code> works on all changelog types such as sql, xml, yaml, and json. Simultaneously, not all <a href="quality-checks-list.htm" title="Learn more about Quality Checks here">Quality Checks</a> work on all changelog types. It is best practice to review which Quality Checks work on the changelog type being used.</p>
        <table style="mc-table-style: url('../../Z_Resources/Stylesheets/TableStyles.css');" cellspacing="0" class="TableStyle-TableStyles">
            <col class="TableStyle-TableStyles-Column-Column1" style="width: auto;" />
            <col class="TableStyle-TableStyles-Column-Column1" style="width: auto;" />
            <col class="TableStyle-TableStyles-Column-Column1" style="width: 202px;" />
            <thead>
                <tr class="TableStyle-TableStyles-Head-Header1">
                    <th class="TableStyle-TableStyles-HeadE-Column1-Header1">Name</th>
                    <th class="TableStyle-TableStyles-HeadE-Column1-Header1">Syntax</th>
                    <th class="TableStyle-TableStyles-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-TableStyles-Body-Body1">
                    <td class="TableStyle-TableStyles-BodyE-Column1-Body1" style="text-align: center;"><code><MadCap:variable name="General.changelog" /></code>
                    </td>
                    <td class="TableStyle-TableStyles-BodyE-Column1-Body1" style="text-align: center;">
                        <p>CLI:</p>
                        <p><code>--checks-scope=changelog</code>
                        </p>
                        <p>Property:</p>
                        <p><code>liquibase.command.checksscope=changelog</code>
                        </p>
                        <p>Environment Variable:</p>
                        <p><code>LIQUIBASE_COMMAND_CHECKS_SCOPE="changelog"</code>
                        </p>
                    </td>
                    <td class="TableStyle-TableStyles-BodyD-Column1-Body1" style="text-align: center;">
                        <p>The attribute which specifies the changelog subset of checks  to run.</p>
                    </td>
                </tr>
                <tr class="TableStyle-TableStyles-Body-Body2">
                    <td class="TableStyle-TableStyles-BodyB-Column1-Body2" style="text-align: center;"><code>database</code>
                    </td>
                    <td class="TableStyle-TableStyles-BodyB-Column1-Body2" style="text-align: center;">
                        <p>CLI:</p>
                        <p><code>--checks-scope=database</code>
                        </p>
                        <p>Property:</p>
                        <p><code>liquibase.command.checksscope=database</code>
                        </p>
                        <p>Environment Variable:</p>
                        <p><code>LIQUIBASE_COMMAND_CHECKS_SCOPE="database"</code>
                        </p>
                    </td>
                    <td class="TableStyle-TableStyles-BodyA-Column1-Body2" style="text-align: center;">
                        <p>The parameter which specifies the database subset of checks  to run.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">One attribute is required to run <code>checks-scope</code> successfully. Both can be used at the same time like so: <code>changelog, database</code> or <code>database, changelog</code></p>
        <h2>Changelog checks-scope Procedure:<br /></h2>
        <p>This example covers how to run <code>checks-scope</code> against a changelog. It begins with a changelog that contains a createTable changeset and no checks enabled. Once the process is complete, the resulting checks will display successfully.</p>
        <p>1. With a changelog that has a createTable changeset with two columns, enable the TableColumnLimit check in the command line like so:<br /><code>liquibase checks enable --check-name=TableColumnLimit</code><br /></p>
        <p> 2. Run the <code>liquibase checks run --checks-scope changelog</code> command.</p>
        <p>3. Run <code>liquibase checks bulk-set --disable</code> to disable any enabled checks.</p>
        <p>Liquibase will ask if you are sure you want to disable all checks.</p>
        <p>4. Type Y to confirm you want to disable all checks.</p>
        <p>5. Run <code>liquibase checks customize --check-name TableColumnLimit</code>.</p>
        <p>6. Set the severity as desired.</p>
        <p>7. Set the Max Columns to 2.</p>
        <p>8. Enable the check.</p>
        <p>9. Run <code>liquibase checks run --checks-scope changelog --changelog-file yourName-createTable-changelog.xml</code>.</p>
        <p>Liquibase has successfully run checks against it's new changelog.</p>
        <h2>Database checks-scope Procedure:</h2>
        <p>Users can establish which database the checks will be run against by specifying the desired database in the --url parameter within the liquibase.properties file or the environment variable equivalent. The database can be a, and typically will be, a JDBC connection string. A <MadCap:xref href="../snapshot/snapshot.html?">Snapshot</MadCap:xref>, which is a reference to a liquibase-created file describing the database, is automatically created if a live JDBC&#160;url is used and any database-scoped checks are enabled. A Snapshot can also be created manually by establishing an offline database url.</p>
        <p>Users should be aware that some data types and settings change when checks-scope database is performed. Some examples are listed below.<br />Integers may become Numeric</p>
        <p>Varchar(max setting can become a clob setting</p>
        <h3>Automatically Create a Snapshot and Run Checks</h3>
        <p>A snapshot of the database is created automatically if a live database url is being used and if a db-scoped check is enabled.  Learn how to navigate this process below.</p>
        <p> 1. Establish the url and reference url in the liquibase.properties file like so:</p><code><p>#### Enter the Target database 'url' information  ####</p><p>liquibase.command.url=jdbc:h2:tcp://localhost:9090/mem:dev</p><p>#### Enter URL for the source database ####</p><p>liquibase.command.referenceUrl: jdbc:h2:tcp://localhost:9090/mem:integration</p></code>
        <p>This establishes the automatic snapshot.</p>
        <p>2. Run the <code>liquibase checks run --checks-scope database</code> command.</p>
        <p>Liquibase has successfully run checks against the database snapshot.</p>
        <h3>Manually Create a Snapshot and Run Checks</h3>
        <p>Users can take a snapshot of their database manually and run checks against it if they prefer using an offline database url. They must first establish a snapshot and then enter the offline location in their liquibase.properties file to run the command successfully. Learn how to navigate this process below.</p>
        <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">It is important to note that this snapshot is not retained.</p>
        <p>1. Run  <code>liquibase --output-file=mySnapshot.json snapshot --snapshotFormat=json</code>to create a snapshot.</p>
        <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">Replace <code>mySnapshot.json</code> and <code>=json</code> with the desired snapshot file title and format.</p>
        <p>2. Add the offline snapshot url to the liquibase.properties file: </p>
        <p>offline:DB_SHORTNAME?snapshot=mySnapshot.json</p>
        <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">Replace <code>DB_SHORTNAME</code> with the database type being used. Such as:&#160;sql, xml, yaml, or json. Also replace  <code>mySnapshot.json</code> with the desired snapshot file title and format.</p>
        <p>The type of database is determined from the URL property if at least one database scope check is enabled. If the database cannot be determined, an sql with H2 is generated automatically to be checked against. </p>
        <p>3. Then run the checks-scope command:</p>
        <p><code>liquibase checks run --checks-scope database --url offline:oracle?snapshot=mySnapshot.json</code>
        </p>
        <p>Checks are run successfully against the database snapshot.</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Output</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>&#160;</p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>When running the <code>checks-scope</code> command with the <code>changelog</code><MadCap:variable name="General.Param/Attribute" />, the output can be as follows:</p><pre><code class="language-text">
Starting Liquibase at 16:35:11 (version [Core: //DAT-9298/2516/e42617/2022-05-11 19:02+0000, Pro: DAT-9298/1208/56ac6a/2022-05-11T18:56:15Z] #2516 built at 2022-05-11 19:02+0000)

Liquibase Version: [Core: //DAT-9298/2516/e42617/2022-05-11 19:02+0000, Pro: DAT-9298/1208/56ac6a/2022-05-11T18:56:15Z]
				
Liquibase Empire [Core: //DAT-9298/2516/e42617/2022-05-11 19:02+0000, Pro: DAT-9298/1208/56ac6a/2022-05-11T18:56:15Z] by Liquibase licensed to Dev until Sat Dec 30 21:59:59 MST 2023

Executing Quality Checks against amber-createTable-changelog.xml


Executing all changelog checks because a valid license key was found!


CHANGELOG CHECKS

				----------------
				
Checks completed validation of the changelog and found the following issues:

				
Changeset ID:       1::createTableforSynonym-PROSCHEMA

Changeset Filepath: amber-createTable-changelog.xml
				
Check Name:         Check Table Column Count (TableColumnLimit)

Check Severity:     MINOR (Return code: 1)

Message:            Table must not have more than 2 columns.

&#160;


Changesets Validated:

ID: 1::createTableforSynonym-PROSCHEMA; Author: Liquibase Pro User; File path: amber-createTable-changelog.xml

Checks run against each changeset:

Check Table Column Count

Liquibase command 'checks run' was executed successfully.


						</code></pre>
        <p>When running the <code>checks-scope</code> command with the automatically created <code>database</code> snapshot, you receive the following output:</p><pre><code class="language-text">
				C:\Users\Amber Williams\Documents\Empire-project&gt;liquibase checks run --checks-scope database
				####################################################
				##   _     _             _ _                      ##
				##  | |   (_)           (_) |                     ##
				##  | |    _  __ _ _   _ _| |__   __ _ ___  ___   ##
				##  | |   | |/ _` | | | | | '_ \ / _` / __|/ _ \  ##
				##  | |___| | (_| | |_| | | |_) | (_| \__ \  __/  ##
				##  \_____/_|\__, |\__,_|_|_.__/ \__,_|___/\___|  ##
				##              | |                               ##
				##              |_|                               ##
				##                                                ##
				##  Get documentation at docs.liquibase.com       ##
				##  Get certified courses at learn.liquibase.com  ##
				##  Free schema change activity reports at        ##
				##      https://hub.liquibase.com                 ##
				##                                                ##
				####################################################
				Starting Liquibase at 12:18:24 (version [Core: //DAT-9298/2516/e42617/2022-05-11 19:02+0000, Pro: DAT-9298/1208/56ac6a/2022-05-11T18:56:15Z] #2516 built at 2022-05-11 19:02+0000)
				Liquibase Version: [Core: //DAT-9298/2516/e42617/2022-05-11 19:02+0000, Pro: DAT-9298/1208/56ac6a/2022-05-11T18:56:15Z]
				Liquibase Empire [Core: //DAT-9298/2516/e42617/2022-05-11 19:02+0000, Pro: DAT-9298/1208/56ac6a/2022-05-11T18:56:15Z] by Liquibase licensed to Dev until Sat Dec 30 21:59:59 MST 2023
				Executing Quality Checks against database jdbc:h2:tcp://localhost:9090/mem:dev

				Executing all database checks because a valid license key was found!

				INFO This command might not yet capture Liquibase Pro additional object types on h2
				Database objects Validated:
				Catalog             : 1
				Schema              : 1

				Checks run against database jdbc:h2:tcp://localhost:9090/mem:dev:
				Check Table Column Count

				Liquibase command 'checks run' was executed successfully.

				C:\Users\Amber Williams\Documents\Empire-project&gt;
</code></pre>
        <p>When running the <code>checks-scope</code> command with the specified offline snapshot url <MadCap:variable name="General.Param/Attribute" />, you receive the following output:</p><pre><code class="language-text">
						Liquibase Community 4.9.1 by Liquibase
						Database snapshot for jdbc:h2:tcp://localhost:9090/mem:integration
						-----------------------------------------------------------------
						Database type: H2
						Database version: 2.1.210 (2022-01-17)
						Database user: DBUSER
						Included types:
						liquibase.structure.core.Catalog
						liquibase.structure.core.Column
						liquibase.structure.core.ForeignKey
						liquibase.structure.core.Index
						liquibase.structure.core.PrimaryKey
						liquibase.structure.core.Schema
						liquibase.structure.core.Sequence
						liquibase.structure.core.Table
						liquibase.structure.core.UniqueConstraint
						liquibase.structure.core.View
						Liquibase command 'snapshot-reference' was executed successfully.
</code></pre>
        <p>Related&#160;Topics:</p>
        <ul>
            <li>
                <MadCap:xref href="../">Find Related Topics and place here.</MadCap:xref>
            </li>
        </ul>
    </body>
</html>