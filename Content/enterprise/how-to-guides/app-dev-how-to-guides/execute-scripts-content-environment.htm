<?xml version="1.0" encoding="utf-8"?>
<html>
    <head><title></title>
    </head>
    <body>
        <h1>How To: Execute scripts with different content depending on the environment<MadCap:snippetText src="../../../Resources/Snippets/images/.ver_icon_size_enterprise.flsnp" /></h1> <MadCap:snippetText src="../../../Resources/Snippets/images/.ver_icon_size_enterprise.flsnp" /><p>All environments in a pipeline may not be the same. Sometimes, schema names are different across environments. It could be that your tablespace (or filegroup in SQL Server) are not consistent. But because you need to deploy the same script in all environments, you need to specify a variable to represent the entity that changes from environment to environment.</p><p>This document walks through the example where the data in a table needs to vary from environment to environment.</p><p>Use case: I need to run DML scripts with different values depending on the environment. For example, I've a CUSTOMER table with the following entry in DEV:</p><p>CUSTOMER - DEV</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col /><col /><col /><col /></colgroup><tbody><tr><th class="confluenceTh">PKey</th><th class="confluenceTh">ID</th><th class="confluenceTh">Data</th><th class="confluenceTh">Load_Ind</th></tr><tr><td class="confluenceTd">1</td><td class="confluenceTd">JD6</td><td class="confluenceTd">First01 Last01</td><td class="confluenceTd">N</td></tr><tr><td class="confluenceTd">2</td><td class="confluenceTd">KY54</td><td class="confluenceTd">First02 Last02</td><td class="confluenceTd">N</td></tr></tbody></table></div><p>In PROD, the content is of course different:</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col /><col /><col /><col /></colgroup><tbody><tr><th class="confluenceTh">PKey</th><th class="confluenceTh">ID</th><th class="confluenceTh">Data</th><th class="confluenceTh">Load_Ind</th></tr><tr><td class="confluenceTd">1</td><td class="confluenceTd">SC98</td><td class="confluenceTd">John Doe</td><td class="confluenceTd">N</td></tr><tr><td class="confluenceTd">2</td><td class="confluenceTd">UI65</td><td class="confluenceTd">Jane Doe</td><td class="confluenceTd">N</td></tr></tbody></table></div><p>&#160;I want to run a script with the following code in DEV</p><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">UPDATE CUSTOMER SET Load_Ind = 'Y' WHERE ID = 'JD6'</pre></div></div><p><span style="color: rgb(0,0,0);">and in PROD</span></p><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">UPDATE CUSTOMER SET Load_Ind = 'Y' WHERE ID = 'SC98'</pre></div></div><h2 id="HowTo:Executescriptswithdifferentcontentdependingontheenvironment-Step-by-stepguide">Step-by-step guide</h2><p>The solution is to use <a class="external-link" href="http://www.liquibase.org/documentation/changelog_parameters.html" rel="nofollow">Changelog&#160;parameters</a> in your changelog.xml.&#160; See also&#160;<a href="execute-scripts-content-environment.htm" rel="nofollow">Setting Properties in the Project Changelog</a>.</p><ol><li><p class="auto-cursor-target">Add the following &lt;property&gt; tags</p><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">&lt;property context="DEV"   dbms="postgresql" name="customer.id" value="JD6"/&gt;&lt;property context="PROD"  dbms="postgresql" name="customer.id" value="SC98"/&gt;</pre></div></div></li><li><p class="auto-cursor-target">Then simply modify your SQL script as follow and add under the<strong> /sql</strong> folder. We will support data_dml and sql_direct</p><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">UPDATE CUSTOMER SET Load_Ind = ‘Y’ WHERE ID = '${customer.id}'</pre></div></div></li></ol><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block"><div class="confluence-information-macro-body"><p>dbms: type of database. Optional. Comma separated list value of values.<br />context: environments. <span>Comma separated list value of values.</span></p></div></div><h2 id="HowTo:Executescriptswithdifferentcontentdependingontheenvironment-Relatedarticles">Related articles</h2><p /><p /><ul class="content-by-label conf-macro output-block"><li><div><span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span></div><div class="details"><a href="execute-scripts-content-environment.htm">How To: Remove abandonded changes from Datical and lower environments</a></div></li><li><div><span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span></div><div class="details"><a href="execute-scripts-content-environment.htm">How To: Deploy Changes to a Specific Environment</a></div></li><li><div><span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span></div><div class="details"><a href="execute-scripts-content-environment.htm">How To: Change Default Location for Datical Projects</a></div></li><li><div><span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span></div><div class="details"><a href="execute-scripts-content-environment.htm">How To: Set default web browser in the GUI</a></div></li><li><div><span class="icon aui-icon aui-icon-small aui-iconfont-page-default" title="Page">Page:</span></div><div class="details"><a href="execute-scripts-content-environment.htm">How To: Update Datical License</a></div></li></ul><p><a href="execute-scripts-content-environment.htm" rel="nofollow">Setting Properties in the Project Changelog</a></p><p><br /></p></body>
</html>