<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
	<head><title><MadCap:variable name="Heading.Level1" /> | Enterprise Docs</title>
		<meta rel="canonical" href="https://docs.liquibase.com/enterprise/developer/dev-how-tos/clear-test-changes.html" />
		<meta name="description" content="Learn how to clear out UAT changes prior to going live." />
	</head>
    <body>
        <h1>How To: Clear out Test Changes (In Preparation For Go-Live)
			<MadCap:snippetText src="../../../Resources/Snippets/images/.ver_icon_size_enterprise.flsnp" /></h1>
        <p>During the user acceptance testing phase (UAT) your <MadCap:variable name="General.DaticalDB" /> project will package several test scripts. These scripts get added to your project's changelog.xml file and these changes could also be deployed into the pipeline, perhaps all the way to the PROD environment.</p>
        <p>How do you clear out those changes prior to go-live such that your project has no test changes (or test data) which you packaged with <MadCap:variable name="General.DaticalDB" />
			? </p>
        <p>This document and video cover those steps:</p><iframe width="420" height="315" src="https://vimeo.com/294182678/0d22ebe524" class="center"></iframe>
        <h3>1. SQL Repository: Clean Out "archive" Directory</h3>
        <p>SQL scripts committed into "data_dml", "ddl_direct", "ddl", "sql", and "sql_direct" folders get archived into the "archive" directory.</p>
        <p><strong>Location:</strong>&#160;Browse into the branch where you commit your SQL scripts (e.g., "develop" branch). The "archive" directory is located in your branch's base directory (e.g., "sql_code", as shown in the screenshot below)</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-thumbnail confluence-content-image-border" width="300" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-51-43.png?version=1&amp;modificationDate=1524666822212&amp;cacheVersion=1&amp;api=v2&amp;width=300&amp;height=193" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-51-43.png?version=1&amp;modificationDate=1524666822212&amp;cacheVersion=1&amp;api=v2&amp;width=470&amp;height=303 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-51-43.png?version=1&amp;modificationDate=1524666822212&amp;cacheVersion=1&amp;api=v2&amp;width=300&amp;height=193 1x" /></span></p>
        <p><strong>Steps to clear out:</strong>&#160;In "archive" directory, delete all subdirectories, including all content.</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="450" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-53-9.png?version=1&amp;modificationDate=1524666822194&amp;cacheVersion=1&amp;api=v2&amp;width=450&amp;height=232" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-53-9.png?version=1&amp;modificationDate=1524666822194&amp;cacheVersion=1&amp;api=v2&amp;width=600&amp;height=310 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-53-9.png?version=1&amp;modificationDate=1524666822194&amp;cacheVersion=1&amp;api=v2&amp;width=450&amp;height=232 1x" /></span></p>
        <p><strong>Important:</strong> Be sure to commit your changes into your SQL repository.</p>
        <p><strong>Note:</strong>&#160;Make sure to merge your branches so that all branches, including "master" are also cleaned out and sync'd up to your main commit branch (e.g. "develop" branch).</p>
        <h3>2. SQL Repository: Remove All Other SQL Scripts</h3>
        <p>Not all scripts get relocated to the "archive" directory. Scripts packaged from these folders stay in their original directories: "function", "package", "packagebody", "procedure", "trigger" and "view". Essentially, these are all stored logic scripts.</p>
        <p>In Step 3 below, you will clean out your "changelog.xml" and in Step 4 you will also clean out your "Resources" directory. Therefore, you will no longer need these stored logic scripts in SQL Repository.</p>
        <p><strong>Note</strong>: It's very important that if you complete Step 2 that you also follow through and complete Steps 3 and 4.</p>
        <p><strong>Location:</strong>&#160;Scripts stay in their original location after packaging. As such, these scripts could be located in any of the following directories under SQL Repository's base directory (e.g., "sql_code", as shown in the screenshot below): "function", "package", "packagebody", "procedure", "trigger" and "view".</p>
        <p><strong><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-thumbnail confluence-content-image-border" width="300" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-59-5.png?version=1&amp;modificationDate=1524666822294&amp;cacheVersion=1&amp;api=v2&amp;width=300&amp;height=217" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-59-5.png?version=1&amp;modificationDate=1524666822294&amp;cacheVersion=1&amp;api=v2&amp;width=488&amp;height=354 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-59-5.png?version=1&amp;modificationDate=1524666822294&amp;cacheVersion=1&amp;api=v2&amp;width=300&amp;height=217 1x" /></span></strong>
        </p>
        <p><strong>Steps to clear out:</strong>&#160;You will need to search for scripts in each of these directories and delete those scripts. Be sure to keep the original directories and subdirectories intact. E.g., if you have subdirectories in the "procedure" directory then you will need to preserve those subdirectories and only remove procedure scripts. You may also have a "<a href="clear-test-changes-preparation-live.htm">metadata.properties</a>" file in these directories which you will also need to preserve.</p>
        <p><strong>Important:</strong>&#160;Do not delete the directory hierarchy (or subdirectories). Also do not delete the <a href="clear-test-changes-preparation-live.htm">metadata.properties</a> file(s). Finally, be sure to commit your changes into your SQL repository.</p>
        <p><strong>Note:</strong>&#160;Make sure to merge your branches so that all branches, including "master" are also cleaned out and sync'd up to your main commit branch (e.g. "develop" branch).</p>
        <h3>
			3. <MadCap:variable name="General.DaticalDB" /> Project: Clean out "changelog.xml" from <MadCap:variable name="General.DaticalDB" /> project</h3>
        <p>Your project's "changelog.xml" file captures database changes that <MadCap:variable name="General.DaticalDB" /> has packaged over time.</p>
        <p><strong>Location</strong>: This file is located in your <MadCap:variable name="General.DaticalDB" /> project directory, in "Changelog" subdirectory</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="350" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-26-53.png?version=1&amp;modificationDate=1524666822532&amp;cacheVersion=1&amp;api=v2&amp;width=350&amp;height=160" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-26-53.png?version=1&amp;modificationDate=1524666822532&amp;cacheVersion=1&amp;api=v2&amp;width=466&amp;height=214 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-26-53.png?version=1&amp;modificationDate=1524666822532&amp;cacheVersion=1&amp;api=v2&amp;width=350&amp;height=160 1x" /></span></p>
        <p><strong>Steps to clear out:</strong> Open the "changelog.xml" in a text editor (e.g., notepad++, atom, etc.). Remove all changesets as shown in the screenshot below.</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="424" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-31-47.png?version=1&amp;modificationDate=1524666822512&amp;cacheVersion=1&amp;api=v2&amp;width=424&amp;height=249" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-31-47.png?version=1&amp;modificationDate=1524666822512&amp;cacheVersion=1&amp;api=v2&amp;width=848&amp;height=498 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-31-47.png?version=1&amp;modificationDate=1524666822512&amp;cacheVersion=1&amp;api=v2&amp;width=424&amp;height=249 1x" /></span></p>
        <p>You should be left with only these lines in your cleaned-out version of the "changelog.xml".</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="600" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-34-20.png?version=1&amp;modificationDate=1524666822550&amp;cacheVersion=1&amp;api=v2&amp;width=600&amp;height=33" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-34-20.png?version=1&amp;modificationDate=1524666822550&amp;cacheVersion=1&amp;api=v2&amp;width=1186&amp;height=66 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-34-20.png?version=1&amp;modificationDate=1524666822550&amp;cacheVersion=1&amp;api=v2&amp;width=600&amp;height=33 1x" /></span></p>
        <p><strong>Important:</strong> Be sure to commit your changes into your <MadCap:variable name="General.DaticalDB" /> project repository.</p>
        <h3>
			4. <MadCap:variable name="General.DaticalDB" /> Project: Clean out "Resources" Directory</h3>
        <p>As you accumulate scripts that have been packaged previously, those scripts get moved to the "Resources" directory in your <MadCap:variable name="General.DaticalDB" /> project. Your changesets in changelog.xml file actually reference these scripts in the "Resources" directory. There could also be subdirectories within the "Resources" directory as shown in the screenshot below. Note these subdirectories: "ddb_tools", "sql", "sql_scripts". There could be other subdirectories too.</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="350" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-38-42.png?version=1&amp;modificationDate=1524666822353&amp;cacheVersion=1&amp;api=v2&amp;width=350&amp;height=216" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-38-42.png?version=1&amp;modificationDate=1524666822353&amp;cacheVersion=1&amp;api=v2&amp;width=488&amp;height=302 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-38-42.png?version=1&amp;modificationDate=1524666822353&amp;cacheVersion=1&amp;api=v2&amp;width=350&amp;height=216 1x" /></span></p>
        <p><strong>Location:</strong> The "Resources" directory is located in your <MadCap:variable name="General.DaticalDB" /> project.</p>
        <p><strong>Steps to clear out:</strong>&#160;In "Resources" directory, delete all subdirectories, including all content.</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="450" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-43-23.png?version=1&amp;modificationDate=1524666822264&amp;cacheVersion=1&amp;api=v2&amp;width=450&amp;height=206" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-43-23.png?version=1&amp;modificationDate=1524666822264&amp;cacheVersion=1&amp;api=v2&amp;width=598&amp;height=274 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_8-43-23.png?version=1&amp;modificationDate=1524666822264&amp;cacheVersion=1&amp;api=v2&amp;width=450&amp;height=206 1x" /></span></p>
        <p><strong>Important:</strong> Be sure to commit your changes into your <MadCap:variable name="General.DaticalDB" /> project repository.</p>
        <h3>
			5. <MadCap:variable name="General.DaticalDB" /> Project: Reset your "sqlScmLastCommitID" in deployPackager.properties File</h3>
        <p><MadCap:variable name="General.DaticalDB" /> project stores the ID of your last commit when it was able to successfully package scripts. This is the pointer that tells <MadCap:variable name="General.DaticalDB" /> to look for new scripts - indicating that <MadCap:variable name="General.DaticalDB" /> will catch incoming scripts since that last successful packaging job. Now that we are resetting all the testing and cleaning out both the <MadCap:variable name="General.DaticalDB" /> project repository as well as the SQL repository this pointer to the last commit ID needs to be reset.</p>
        <p><strong>Location:</strong>&#160;The "sqlScmLastImportID" is located in "<a href="clear-test-changes-preparation-live.htm" rel="nofollow">deployPackager.properties</a>" file in the <MadCap:variable name="General.DaticalDB" /> project directory.</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-thumbnail confluence-content-image-border" width="300" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-16-28.png?version=1&amp;modificationDate=1524666822356&amp;cacheVersion=1&amp;api=v2&amp;width=300&amp;height=239" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-16-28.png?version=1&amp;modificationDate=1524666822356&amp;cacheVersion=1&amp;api=v2&amp;width=397&amp;height=317 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-16-28.png?version=1&amp;modificationDate=1524666822356&amp;cacheVersion=1&amp;api=v2&amp;width=300&amp;height=239 1x" /></span></p>
        <p>Note that there could be multiple instances of this property - typically once for each pipeline:</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="400" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-19-59.png?version=1&amp;modificationDate=1524666822485&amp;cacheVersion=1&amp;api=v2&amp;width=400&amp;height=243" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-19-59.png?version=1&amp;modificationDate=1524666822485&amp;cacheVersion=1&amp;api=v2&amp;width=505&amp;height=308 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-19-59.png?version=1&amp;modificationDate=1524666822485&amp;cacheVersion=1&amp;api=v2&amp;width=400&amp;height=243 1x" /></span></p>
        <p><strong>Steps to reset:</strong>&#160;These IDs need to be reset to the new commits you made in Steps 3 and 4 above. You can retrieve your new commit IDs from your SCM tool. For example, if you use Git Bash, you will first need to change directory to your cloned SQL repository and then type "<code>git log -1</code>". The "-1" argument will give you the latest commit ID. You can also type "git log" without any arguments and it will return a screen full of chronologically ordered commit IDs and you will then select the first entry from this output. Copy this commit ID and paste it into your <MadCap:variable name="General.DaticalDB" /> project's "<a href="clear-test-changes-preparation-live.htm" rel="nofollow">deployPackager.properties</a>" file:</p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="450" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-28-6.png?version=1&amp;modificationDate=1524666822323&amp;cacheVersion=1&amp;api=v2&amp;width=450&amp;height=182" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-28-6.png?version=1&amp;modificationDate=1524666822323&amp;cacheVersion=1&amp;api=v2&amp;width=617&amp;height=250 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-28-6.png?version=1&amp;modificationDate=1524666822323&amp;cacheVersion=1&amp;api=v2&amp;width=450&amp;height=182 1x" /></span></p>
        <p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="450" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-28-41.png?version=1&amp;modificationDate=1524666822295&amp;cacheVersion=1&amp;api=v2&amp;width=450&amp;height=246" srcset="https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-28-41.png?version=1&amp;modificationDate=1524666822295&amp;cacheVersion=1&amp;api=v2&amp;width=561&amp;height=307 2x, https://datical-cs.atlassian.net/wiki/download/thumbnails/546242626/image2018-4-16_9-28-41.png?version=1&amp;modificationDate=1524666822295&amp;cacheVersion=1&amp;api=v2&amp;width=450&amp;height=246 1x" /></span></p>
        <p><strong>Important:</strong> Be sure to commit your changes into your <MadCap:variable name="General.DaticalDB" /> project repository.</p>
        <p><strong>Note:</strong> Repeat this step for each branch in your SQL Repository.</p>
        <h3>6. Clean out Objects from Your Databases</h3>
        <ol>
            <li>Remove all data from "DATABASECHANGELOG" table in each database that's in your <MadCap:variable name="General.DaticalDB" /> project. This includes all pipelines.</li>
            <li>Clean up database test objects that were deployed - such as tables, views, procedures, etc.</li>
        </ol>
        <h3>7. (OPTIONAL) Clean out Artifacts</h3>
        <p>If you use JFrog Artifactory or Nexus or any other artifacts repository, you may want to clean out your older artifacts versions that were created during testing/validation.</p>
        <p>Alternately, if deleting those artifacts is not allowed, determine a way to tag old artifacts such that those artifacts are no longer usable or available for <MadCap:variable name="General.DaticalDB" /> deploy jobs.</p>
        <p>Another thing to do is to make sure to create a new artifact with no changesets and start using artifact versions from this point onwards.</p>
        <h3>8. (OPTIONAL) Refresh environments from PROD</h3>
        <p>Take the DDL from PROD and apply it to the other environments. (In this clean up scenario you don't have to copy the data from databasechangelog and databasechangeloglock tables from PROD to the other environments as you typically would during a refresh for other reasons, because we already removed the data in step 6 above so the databasechangelog tables are empty.)</p>
    </body>
</html>