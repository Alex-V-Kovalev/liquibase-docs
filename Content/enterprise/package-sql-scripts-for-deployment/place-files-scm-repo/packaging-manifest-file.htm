<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Liquibase Enterprise Documentation</title>
        <meta name="description" content="Liquibase Enterprise Documentation" />
    </head>
    <body>
        <h1>Packaging from a Manifest File</h1>
        <MadCap:snippetText src="../../../Resources/Snippets/images/.ver_icon_size_enterprise.flsnp" />
        <p>This functionality is maintained for backward compatibility with older methodologies. </p>
        <p>The current recommended methodology for introducing database changes is to check SQL scripts into a source control repository and then package them into changesets.</p>
        <p>You can create a manifest file to specify a set of SQL scripts to be packaged.</p>
        <p>The manifest file specifies information for packaging:</p>
        <ul>
            <li>location of scripts to be processed</li>
            <li>metadata associated with these scripts</li>
            <li>order of processing</li>
        </ul>
        <p>When using a manifest mode, a&#160;deployPackager.properties file is required. It provides the location to use for database backups, <code>databaseBackupRestoreLocation</code>.</p>
        <h2 id="PackagingfromaManifestFile-MetadataDefinitions">Metadata Definitions</h2>
        <table>
            <tbody>
                <tr>
                    <td>
                        <p><span><strong>Field Name</strong></span>
                        </p>
                    </td>
                    <td>
                        <p><span><strong>Field Description</strong></span>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p><span><strong>author</strong></span>
                        </p>
                    </td>
                    <td>
                        <p><span>Name of the person who authored the SQL scripts</span>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p><span><strong>comment</strong></span>
                        </p>
                    </td>
                    <td>
                        <p><span>Any relevant comments related to this group of SQL scripts</span>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p><span><strong>labels</strong></span>
                        </p>
                    </td>
                    <td>
                        <p><span>One or more labels that identify this set of changes so they can be easily identified and deployed as a group</span>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p><span><strong>contexts</strong></span>
                        </p>
                    </td>
                    <td>
                        <p><span>Identifier to tie a set of changes to specific environments.</span>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 id="PackagingfromaManifestFile-SQLFileDefinitions">SQL File Definitions</h2>
        <table>
            <tbody>
                <tr>
                    <td>
                        <p><span><strong>Field Name</strong></span>
                        </p>
                    </td>
                    <td>
                        <p><span><strong>Field Description</strong></span>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p><span><strong>type</strong></span>
                        </p>
                    </td>
                    <td>
                        <p><span>Type of file being processed – sqlfile, sqlplus, function, package, packagebody, procedure, data_dml, ddl</span>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p><span><strong>filename</strong></span>
                        </p>
                    </td>
                    <td>
                        <p><span>SQL file used for deploy. Use an absolute path or a relative path plus an sqlScmPath setting.</span>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p><span><strong>rollbackFile</strong></span>
                        </p>
                    </td>
                    <td>
                        <p>QL file used for rollback. Use an absolute path or a relative path plus an sqlScmPath setting.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 id="PackagingfromaManifestFile-UsingRelativePaths">Using Relative Paths</h2>
        <p>You can use a relative path for filename and rollbackFile if you also provide a value for sqlScmPath in deployPackager.properties. The filename used is constructed from the two values.</p>
        <p>Example: The following example shows how to set sqlScmPath and use a relative path in filename.</p>
        <ul>
            <li>SQL files location - <code>C:/Users/jsmith/datical/project/sql_code/procedure</code></li>
            <li>sqlScmPath - <code>C:/Users/<code>jsmith</code>/datical/project/sql_code/</code></li>
            <li>filename - <code>procedure/0001_P_POSTS_HAS_COMMENTS_NUM.sql</code></li>
        </ul>
        <h2 id="PackagingfromaManifestFile-Portability">Portability</h2>
        <p>Using relative paths supports manifest file portability. When set up to use relative paths, the same manifest file could be used on multiple systems.</p>
        <ul>
            <li>Systems of the same type</li>
            <li>Systems of different types (Windows and Linux, for example)</li>
        </ul>
        <p>In order to make a manifest file portable, you need to do the following:</p>
        <ol>
            <li>Assure that the same relative path can work (compare the environments on the systems you plan to use)</li>
            <li>Set the sqlScmPath value appropriately on each system.</li>
        </ol>
        <h3 id="PackagingfromaManifestFile-ExampleofPortability">Example of Portability</h3>
        <p>The path is two directories deeper on the Windows system.</p>
        <table>
            <tbody>
                <tr>
                    <th>
                        <br />
                    </th>
                    <th>Local absolute path to SQL file</th>
                    <th>Relative Path in Manifest File</th>
                    <th>sqlScmPath value</th>
                </tr>
                <tr>
                    <td>
                        <p>System A<br />(Windows)</p>
                    </td>
                    <td><code>C:/Users/<code>jsmith</code>/datical/project/sql_code/procedure/proc01.sql</code>
                    </td>
                    <td><code>procedure/proc01.sql</code>
                    </td>
                    <td><code>C:/Users/<code>jsmith</code>/datical/project/sql_code/</code>
                    </td>
                </tr>
                <tr>
                    <td>System B<br />(Linux)</td>
                    <td><code>/home/<code>jsmith</code>/project/sql_code/procedure/<code>proc01.sql</code><br /></code>
                    </td>
                    <td><code>procedure/proc01.sql</code>
                    </td>
                    <td><code>/home/<code>jsmith</code>/project/sql_code/</code>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 id="PackagingfromaManifestFile-GeneratingtheManifestFile">Generating the Manifest File</h2>
        <p>
			The 
			<MadCap:variable name="General.DaticalDB" />
			GUI provides a wizard for authoring manifest files. The files can also be authored manually in a text editor.
		</p>
        <h3 id="PackagingfromaManifestFile-ExampleManifestFile">Example Manifest File</h3>
        <p>The following manifest file specifies the following changes to package:</p>
        <ul>
            <li>DDL script, no rollback file</li>
            <li>Procedure (stored logic), with a rollback file</li>
        </ul><pre xml:space="preserve">[
   {"author": "Smith, John"},
   {"comment": "Sprint 21 Release"},
   {"labels": "0351051"},
   {"contexts": ""},
   {"sqlfile": 
      {
         "sqltype": "ddl",
         "deployfile": "C:/Users/jsmith/datical/Blog_Import/sql_code/ddl/0001_create_table-review.sql",
         "rollbackfile": ""      }
   },
   {"sqlfile":
      {
         "sqltype": "procedure",
         "deployfile":
         "C:/Users/jsmith/datical/Blog_Import/sql_code/procedure/0001_P_POSTS_HAS_COMMENTS_NUM.sql",
         "rollbackfile":
         "C:/Users/jsmith/datical/Blog_Import/sql_code/procedure/0001_P_POSTS_HAS_COMMENTS_NUM-rollback.sql"      }
   }
]</pre>
    </body>
</html>