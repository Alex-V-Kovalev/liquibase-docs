<?xml version="1.0" encoding="utf-8"?>
<html>
    <head><title></title>
    </head>
    <body>
        <h1>Rollback Script Handling</h1>
        <p><span style="color: rgb(51,51,51);">If you have provided a custom rollback script for a <strong><em>non-DDL</em></strong> SQL script, then you normally do the following:</span>
        </p>
        <ul>
            <li><span style="color: rgb(51,51,51);">Replace the original script: write a -replace or _replace script.</span>
            </li>
            <li><span style="color: rgb(51,51,51);">Edit its existing custom rollback script.&#160;</span>
            </li>
        </ul>
        <p><span style="color: rgb(51,51,51);">A non-DDL script is one that is not packaged in the ddl directory.&#160;</span>
        </p>
        <div class="confluence-information-macro confluence-information-macro-information conf-macro output-block">
            <div class="confluence-information-macro-body">
                <p>Do not use a <code>-replace</code>/_replace script for a rollback script (<code>myscript-rollback-replace</code>). Packaging fails with an error if a script using <code>-rollback-replace</code> is found.&#160;&#160;</p>
                <p>Rollback scripts are always repackaged. When you change them, the version is incremented.&#160;</p>
            </div>
        </div>
        <p><span style="color: rgb(51,51,51);">See also&#160;<a href="Rolling_Back_Changes.htm" rel="nofollow">Rolling Back Changes</a>.&#160;</span>
        </p>
        <h1 id="RollbackScriptHandling-ExampleScripts"><span style="color: rgb(51,51,51);">Example Scripts</span>
        </h1>
        <p><span style="color: rgb(51,51,51);">The following scenarios start with an existing SQL script and a custom rollback script for it.&#160;</span>
        </p>
        <ul>
            <li><code><span style="color: rgb(51,51,51);">myscript.sql</span></code>
            </li>
            <li><code><span style="color: rgb(51,51,51);">myscript-rollback.sql or myscript_rollback.sql</span></code>
            </li>
        </ul>
        <h1 id="RollbackScriptHandling-ExplicitReplacementofBothFiles"><span style="color: rgb(51,51,51);">Explicit Replacement of Both Files</span>
        </h1>
        <p><span style="color: rgb(51,51,51);">You want to replace the existing script and modify its rollback behavior. Write a replace script for the original script and update its custom rollback script. Package them in the same packaging run.&#160;</span>
        </p>
        <ul>
            <li><code><span style="color: rgb(51,51,51);">myscript-replace.sql or myscript_replace.sql</span></code>
            </li>
            <li><code><span style="color: rgb(51,51,51);">myscript-rollback.sql or myscript_rollback.sql</span></code>
            </li>
        </ul>
        <h1 id="RollbackScriptHandling-ImplicitUsageofExistingRollbackScript"><span style="color: rgb(51,51,51);">Implicit Usage of Existing Rollback Script</span>
        </h1>
        <p><span style="color: rgb(51,51,51);">You want to replace the existing file but do not want to update its custom rollback script.&#160;&#160;</span>
        </p>
        <ul>
            <li><code><span style="color: rgb(51,51,51);">myscript-replace.sql or myscript_replace.sql</span></code>
            </li>
        </ul>
        <p><span style="color: rgb(51,51,51);">In this case, <code>myscript-rollback.sql or myscript_rollback.sql</code> is replaced and the rollback script is repackaged for use with the replacement script. Its version is incremented.&#160;</span>
        </p>
        <h1 id="RollbackScriptHandling-ReplacingOnlyaRollbackScript"><span style="color: rgb(51,51,51);">Replacing Only a Rollback Script</span>
        </h1>
        <p><span style="color: rgb(51,51,51);">You want to replace a rollback script. You can do this at any time, regardless of whether you are replacing the original script.</span>
        </p>
        <ul>
            <li><code><span style="color: rgb(51,51,51);">myscript-rollback.sql or myscript_rollback.sql</span></code>
            </li>
        </ul>
        <p><span style="color: rgb(51,51,51);">In this case, edit&#160;</span><code>myscript-rollback.sql</code>&#160;or myscript_rollback.sql in place. During the packaging run it&#160;<span style="color: rgb(51,51,51);">is repackaged and its version is incremented.&#160;</span></p>
        <h1 id="RollbackScriptHandling-CasesWhereRollbackScriptsAreNotAllowed"><span style="color: rgb(51,51,51);">Cases Where Rollback Scripts Are Not Allowed</span>
        </h1>
        <ul>
            <li><span style="color: rgb(51,51,51);">Liquibase changelogs. See <a href="Packaging_Liquibase_Changelogs.htm">Packaging Liquibase Changelogs</a>. </span>
            </li>
        </ul>
    </body>
</html>