<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title><MadCap:variable name="Heading.Level1" /></title>
        <meta rel="canonical" href="https://docs.liquibase.com/start/tutorials/neo4j.html" />
        <meta name="description" content="This page guides you through the process of creating a new Liquibase project with Neo4j." />
    </head>
    <body>
        <h1>Using <MadCap:variable name="General.Liquibase" /> with Neo4j</h1>
        <p><a href="https://neo4j.com/">Neo4j</a> is a property graph database management system with native graph storage and processing. It uses a graph query language called <a href="https://neo4j.com/docs/getting-started/current/cypher-intro/">Cypher</a>. For more information, see <a href="https://neo4j.com/docs/">Neo4j Documentation</a>.</p>
        <h2>Supported versions</h2>
        <ul>
            <li>3.5+</li>
        </ul>
        <h2>Prerequisites</h2>
        <MadCap:snippetBlock src="../../Z_Resources/Snippets/text/database-prerequisites.flsnp" />
        <p>To access Neo4j, do one of the following:</p>
        <ul>
            <li><a href="https://neo4j.com/download/">Download Neo4j Desktop locally</a>
            </li>
            <li><a href="https://hub.docker.com/_/neo4j">Configure Neo4j locally with Docker</a>
            </li>
            <li><a href="https://neo4j.com/cloud/platform/aura-graph-database/">Create a Neo4j AuraDB&#160;cloud instance</a>
            </li>
            <li><a href="https://neo4j.com/sandbox/">Launch a Neo4j Aura&#160;sandbox instance</a>
            </li>
        </ul>
        <h2>Install drivers</h2>
        <p>To use <MadCap:variable name="General.Liquibase" /> and Neo4j, you need the latest JAR from the <a href="https://mvnrepository.com/artifact/org.liquibase.ext/liquibase-neo4j">Liquibase extension for Neo4j</a> (<a href="https://github.com/liquibase/liquibase-neo4j/releases">GitHub link</a>).</p>
        <MadCap:snippetBlock src="../../Z_Resources/Snippets/text/database-driver.flsnp" MadCap:conditionTagExpression="include[database-driver.driver-manually-installed or database-driver.maven-jar-public]" /><pre xml:space="preserve"><code class="language-text">&lt;dependency&gt;
    &lt;groupId&gt;org.liquibase.ext&lt;/groupId&gt;
    &lt;artifactId&gt;liquibase-neo4j&lt;/artifactId&gt;
    &lt;version&gt;<MadCap:variable name="General.CurrentLiquibaseVersion" />&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
        <p>The Neo4j extension has native JDBC connectivity support in version 4.19.0+. If you're using an earlier version, you must also install a third-party <a href="https://github.com/neo4j-contrib/neo4j-jdbc">JDBC driver</a> to connect to <MadCap:variable name="General.Liquibase" />. For driver configuration information, see <a href="https://github.com/liquibase/liquibase-neo4j/blob/main/docs/reference-configuration.md">Neo4j Configuration</a>. For additional JARs to integrate Neo4j with your preferred programming language, see <a href="https://neo4j.com/docs/getting-started/current/languages-guides/">Connecting to Neo4j</a>.</p>
        <h2>Test your connection</h2>
        <ol>
            <li>Ensure your Neo4j database is configured. See <a href="https://neo4j.com/docs/operations-manual/current/">Neo4j Operations Manual</a> and <a href="https://neo4j.com/docs/aura/auradb/getting-started/create-database/">Neo4j AuraDB: Creating an instance</a> for more information.</li>
            <li>
                <MadCap:snippetText src="../../Z_Resources/Snippets/text/database-properties-url.flsnp" /> </li><pre xml:space="preserve"><code class="language-text">url: jdbc:neo4j:bolt://&lt;host&gt;:&lt;port&gt;/?username=foo,password=bar</code></pre>
            <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;"> The <MadCap:variable name="General.Liquibase" /> extension for Neo4j only supports connections through the Bolt protocol, not HTTP.</p>
            <p>For more information about the JDBC connection, see <a href="http://neo4j-contrib.github.io/neo4j-jdbc/#_technical_reference">Neo4j JDBC Driver Documentation § Technical Reference</a>.</p>
            <MadCap:snippetBlock src="../../Z_Resources/Snippets/note/database-license-key.flsnp" />
        </ol>
        <ol start="3">
            <li>Create a text file called <a href="../../concepts/changelogs/home.html">changelog</a> (<code>.xml</code>, <code>.cypher</code>, <code>.json</code>, or <code>.yaml</code>) in your project directory and add a <a href="../../concepts/changelogs/changeset.html">changeset</a>. The <code>&lt;neo4j:cypher&gt;</code>&#160;<MadCap:variable name="General.changetypes" /> has the same behavior as the <code>&lt;<MadCap:xref href="../../change-types/sql.html">sql</MadCap:xref>&gt;</code>&#160;<MadCap:variable name="General.changetypes" />. For more information about Cypher syntax, see the <a href="https://neo4j.com/docs/cypher-manual/current/introduction/">Neo4j Cypher Manual</a> (general syntax) the <a href="https://github.com/liquibase/liquibase-neo4j/blob/main/docs/reference-features.md">Neo4j Extension Cypher Manual</a> (<MadCap:variable name="General.Liquibase" /> syntax).</li>
            <MadCap:dropDown>
                <MadCap:dropDownHead>
                    <MadCap:dropDownHotspot style="font-size: 18pt;">XML example</MadCap:dropDownHotspot>
                </MadCap:dropDownHead>
                <MadCap:dropDownBody><pre xml:space="preserve"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
<MadCap:snippetText src="../../Z_Resources/Snippets/code/liquibase-xsd-xml-changelog-closed.flsnp" />
    &lt;changeSet id="1" author="Liquibase"&gt;
        &lt;neo4j:cypher&gt;CREATE (:TestNode {test_property: "Value"});&lt;/neo4j:cypher&gt;
    &lt;/changeSet&gt;
&lt;/databaseChangeLog&gt;</code></pre>
                </MadCap:dropDownBody>
            </MadCap:dropDown>
            <MadCap:dropDown>
                <MadCap:dropDownHead>
                    <MadCap:dropDownHotspot style="font-size: 18pt;">Cypher (SQL) example</MadCap:dropDownHotspot>
                </MadCap:dropDownHead>
                <MadCap:dropDownBody><pre xml:space="preserve"><code class="language-sql">-- liquibase formatted cypher

-- changeset liquibase:1
CREATE (:TestNode {test_property: "Value"});</code></pre>
                    <p class="tip" MadCap:autonum="&lt;b&gt;Tip: &lt;/b&gt;">Formatted SQL/Cypher <MadCap:variable name="General.changelog" />s generated from <MadCap:variable name="General.Liquibase" /> versions before 4.2 might cause issues because of the lack of space after a double dash ( <code>--</code> ). To fix this, add a space after the double dash. For example: <code>--&#160;liquibase formatted cypher</code> instead of <code>--liquibase formatted cypher</code> and <code>--&#160;changeset myname:create</code> instead of <code>--changeset myname:create</code>.</p>
                </MadCap:dropDownBody>
            </MadCap:dropDown>
            <MadCap:dropDown>
                <MadCap:dropDownHead>
                    <MadCap:dropDownHotspot style="font-size: 18pt;">YAML example</MadCap:dropDownHotspot>
                </MadCap:dropDownHead>
                <MadCap:dropDownBody><pre xml:space="preserve"><code class="language-yaml">databaseChangeLog:
   - changeSet:
       id: 1
       author: Liquibase
       changes:
       - neo4j:cypher:
           sql: CREATE (:TestNode {test_property: "Value"});</code></pre>
                </MadCap:dropDownBody>
            </MadCap:dropDown>
            <MadCap:dropDown>
                <MadCap:dropDownHead>
                    <MadCap:dropDownHotspot style="font-size: 18pt;">JSON example</MadCap:dropDownHotspot>
                </MadCap:dropDownHead>
                <MadCap:dropDownBody><pre><code class="language-json">{
  "databaseChangeLog": [
    {
      "changeSet": {
        "id": "1",
        "author": "Liquibase",
        "changes": [
          {
            "neo4j:cypher": {
              "sql": CREATE (:TestNode {test_property: "Value"});
            }
          }
        ]
      }
    }
  ]
}</code></pre>
                </MadCap:dropDownBody>
            </MadCap:dropDown>
            <li>Navigate to your project folder in the CLI and run the <MadCap:variable name="General.Liquibase" />&#160;<MadCap:xref href="../../commands/change-tracking/status.htm">status</MadCap:xref> command to see whether the connection is successful:</li><pre xml:space="preserve"><code class="language-text">liquibase status --username=test --password=test --changelog-file=&lt;changelog.xml&gt;</code></pre>
            <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">You can pass arguments in the CLI or keep them in the <MadCap:variable name="General.Liquibase" /> properties file.</p>
            <li>Inspect the SQL with  the <MadCap:xref href="../../commands/update/update-sql.htm">update-sql</MadCap:xref> command. Then make changes to your database with the <MadCap:xref href="../../commands/update/update.html">update</MadCap:xref> command.</li><pre xml:space="preserve"><code class="language-text">liquibase update-sql --changelog-file=&lt;changelog.xml&gt;
liquibase update --changelog-file=&lt;changelog.xml&gt;</code></pre>
            <li>
                <p>From the Neo4j browser, ensure that your database contains the <MadCap:variable name="General.changelog" /> node by running <code>MATCH (c:__LiquibaseChangeLog) RETURN c</code>.</p>
                <p class="note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt;">The <code>__LiquibaseChangeLogLock</code> node is only present during an active <MadCap:variable name="General.Liquibase" /> execution, not after, so it isn't normally visible.</p>
            </li>
        </ol>
        <h2>Related links</h2>
        <ul>
            <li><a href="https://neo4j.com/labs/liquibase/docs/">Neo4j documentation: Neo4j Plugin for Liquibase</a>
            </li>
            <li><a href="https://neo4j.com/docs/getting-started/current/">Neo4j documentation: Welcome to Neo4j</a>
            </li>
            <li><a href="https://neo4j.com/docs/getting-started/current/appendix/graphdb-concepts/">Neo4j documentation: Graph database concepts</a>
            </li>
        </ul>
    </body>
</html>