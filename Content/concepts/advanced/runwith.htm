<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <title>runWith attribute | Liquibase Docs</title>
        <meta name="description" content="Reference information for the runWith attribute. The runWith attribute allows you to specify an executor to your your SQL in Liquibase." />
    </head>
    <body>
        <h1> runWith <MadCap:variable name="General.changeset" /> attribute</h1>
        <h2 id="sql-plus-integration-and-custom-executors-using-runWith-attribute">SQL Plus integration and custom executors using <code>runWith</code> attribute</h2>
        <p>Devs, DBAs, and many others use <MadCap:variable name="General.Liquibase" /> to track their database changes in SQL, XML, JSON or YAML <MadCap:variable name="General.changelog" style="font-style: italic;" /><i>s</i>, almost always processed over traditional JDBC connections. While this works for most people most of the time, there are occasions when the JDBC connector has trouble processing highly-specialized or variable-rich SQL.</p>
        <p>For <MadCap:variable name="General.LBCommunity" /> and <MadCap:variable name="General.LBPro" /> users, the optional <MadCap:variable name="General.changeset" style="font-style: italic;" /> attribute, <code>runWith="&lt;executor&gt;"</code> allows you to specify an executor to run your SQL. This capability works with <MadCap:variable name="General.changeset" style="font-style: italic;" /><i>s</i> in Formatted SQL <MadCap:variable name="General.changelog" style="font-style: italic;" /><i>s</i>, and in <MadCap:variable name="General.changeset" style="font-style: italic;" /><i>s</i> which are in XML, JSON, YAML <MadCap:variable name="General.changelog" style="font-style: italic;" /><i>s</i> which call inline SQL or <code>sqlFile</code> tagged <MadCap:variable name="General.changeset" style="font-style: italic;" /><i>s</i>.</p>
        <h2>SQL Plus integration via <code>runWith</code> for <MadCap:variable name="General.LBPro" /> users</h2>
        <p>For <MadCap:variable name="General.LBPro" /> users, SQL Plus integration is built-in.</p>
        <ol>
            <li>Make sure you have the latest version of <MadCap:variable name="General.Liquibase" /> (download <MadCap:variable name="General.Liquibase" /> 3.10.0 or higher).</li>
            <li>Have SQL Plus in your PATH (or configure it in the accompanying <code>liquibase.sqlplus.conf</code> file).</li>
            <li>Add <code>runWith="sqlplus"</code> attribute to a <MadCap:variable name="General.changeset" style="font-style: italic;" />.</li>
        </ol>
        <h2 id="runwith-example">runWith examples:</h2>
        <p>
            <strong>Formatted SQL <MadCap:variable name="General.changeset" /> using <code>runWith</code> attribute</strong>
        </p>
        <pre xml:space="preserve">
            <code class="language-html">
--liquibase formatted sql
				
--changeset myauthorname:2314 runwith:sqlplus
			
	DECLARE l_emp_name VARCHAR2(250);	
	l_emp_no NUMBER;	
	l_salary NUMBER;	
			
	l_manager VARCHAR2(250);	
	BEGIN	
	INSERT INTO emp(emp_name,emp_no,salary,manager) VALUES('BBB',1000,25000,'AAA');
	
	...[and so on]...	
	END;		
	/
		</code>
        </pre>
        <p>
            <strong>XML <MadCap:variable name="General.changelog" style="font-style: italic;" /> with inline SQL <MadCap:variable name="General.changeset" style="font-style: italic;" /> using <code>runWith</code> attribute</strong>
        </p>
        <pre xml:space="preserve">
            <code class="language-xml" data-lang="xml">&lt;changeSet id="2" author="myauthorname" runWith="sqlplus"&gt; 
&lt;sql&gt;
	DECLARE l_emp_name VARCHAR2(250);
	l_emp_no NUMBER;
	l_salary NUMBER;
	l_manager VARCHAR2(250);
BEGIN
	INSERT INTO emp(emp_name,emp_no,salary,manager) VALUES('BBB',1000,25000,'AAA');
	...[and so on]...
	END;
	/
&lt;/sql&gt; 

&lt;/changeSet&gt;</code>
        </pre>
        <p>
            <b>XML/YAML/JSON <MadCap:variable name="General.changelog" style="font-style: italic;" /> pointing to an SQL file with raw SQL in it</b>
        </p>
        <pre xml:space="preserve">
            <code class="language-xml" data-lang="xml">&lt;changeSet id="2315" author="myauthorname" runWith="sqlplus"&gt;  
	&lt;sqlFile
	path="my/path/file.sql"
...etc etc... &gt; 
&lt;/changeSet&gt;</code>
        </pre>
        <h2>The optional <code>.conf </code>file</h2>
        <p>For <MadCap:variable name="General.LBPro" /> users, there is a <code>liquibase.sqlplus.conf</code> file which lives alongside your <code>liquibase.properties</code>, where you can optionally specify some useful key-value pairs for configuring your executor, such as:</p>
        <ol>
            <li>Configuration to keep the temporary SQL file generated when using a native executor. For <code>sqlplus</code>:</li>
        </ol>
        <p>
            <code>liquibase.sqlplus.keep.temp=[true|false=default]</code>
        </p>
        <p>For example, when the user encounters an error in the native execution, it stops. We throw a ERROR telling them user execution has stopped, and if they would like to know more, they should set</p>
        <p>
            <code>liquibase.sqlplus.keep.temp=true</code>
        </p>
        <ol MadCap:continue="true">
            <li>Configuring the length of timeout, or period to wait for some response from SQL Plus, set:</li>
        </ol>
        <p>
            <code>liquibase.sqlplus.timeout=&lt;number in seconds&gt;</code>
        </p>
        <ul>
            <li>"–1" disables the timeout &amp; lets you hang yourself</li>
            <li>“0” returns an error</li>
            <li>default is 1800 seconds (30 minutes!)</li>
        </ul>
        <h2>Open and custom executor extensibility</h2>
        <p>True to open-source and open-extensibility, <MadCap:variable name="General.LBCommunity" /> and <MadCap:variable name="General.LBPro" /> users can write their own classes to integrate their own executor. Say, for example, you need an encrypted JDBC tool, which you want to call as “<code>ejdbc</code>” from your <MadCap:variable name="General.changeset" style="font-style: italic;" />? We've included an example executor with the 3.10.0 release files so you can see exactly how to do the following:</p>
        <ul>
            <li>Write and configure the classes to call your tool.</li>
            <li>Optionally, set up a <code>.conf</code> file (in this example, it would be named <code>liquibase.ejdbc.conf</code>).</li>
            <li>Add <code>runWith="ejdbc"</code> to select <MadCap:variable name="General.changeset" style="font-style: italic;" /><i>s</i> to process them with your custom executor.</li>
        </ul>
    </body>
</html>