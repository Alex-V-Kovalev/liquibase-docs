<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title><MadCap:variable name="Heading.Level1" /></title>
        <meta rel="canonical" href="https://docs.liquibase.com/concepts/changelogs/changeset-checksums.html" />
        <meta name="description" content="Explanation of how changeset checksums work in Liquibase." />
    </head>
    <body>
        <h1>Changeset Checksums</h1>
        <p>When <MadCap:variable name="General.Liquibase" /> reaches a <MadCap:xref href="changeset.html">Changeset</MadCap:xref> in your <MadCap:xref href="home.html">Changelog</MadCap:xref> during execution, it computes a checksum and stores it in the <code>MD5SUM</code>&#160;column of the <MadCap:xref href="../tracking-tables/databasechangelog-table.html">[%=General.databasechangelog%] table</MadCap:xref>. This tells <MadCap:variable name="General.Liquibase" /> if  the <MadCap:variable name="General.changeset" /> has been modified since it was run.</p>
        <h2>Validation failures</h2>
        <p>If the <MadCap:variable name="General.changeset" /> has been modified since it was run, <MadCap:variable name="General.Liquibase" /> halts and displays an error:</p><pre xml:space="preserve"><code class="language-text">Validation Failed:
 1 change sets check sum
com/example/changelog.xml::1::example was: 8:63f82d4ff1b9dfa113739b7f362bd37d but is now: 8:b4fd16a20425fe377b00d81df722d604</code></pre>
        <p>In this example, <code>com/example/changelog.xml::1::example</code> is the <MadCap:variable name="General.changeset"></MadCap:variable> identifier, <code>8:63f…</code> is the old checksum, and <code>8:b4f…</code> is the new checksum.</p>
        <p>This message displays because <MadCap:variable name="General.Liquibase" /> cannot identify what was changed and the 
database may be in a state different than what the <MadCap:variable name="General.changelog" /> is expecting. If there was a valid reason for the <MadCap:variable name="General.changeset" /> to be changed and you want to ignore this error, there are three options:</p>
        <h3><MadCap:variable name="General.databasechangelog" />
        </h3>
        <p>The first option is to manually update the <MadCap:variable name="General.databasechangelog" /> table so that the row with the corresponding <code>id/author/filepath</code> has a null value for the checksum. <b>You must do this for all environments where the <MadCap:variable name="General.changeset" /> has been deployed.</b></p>
        <p>The next time you run the <code><MadCap:xref href="../../commands/update/update.html">update</MadCap:xref></code> command, <MadCap:variable name="General.Liquibase" /> updates the checksum value to the new correct value.</p>
        <h3><code class="highlighter-rouge">validCheckSum</code>
        </h3>
        <p>The second option is to add a <code class="highlighter-rouge">&lt;validCheckSum&gt;</code> tag to the <MadCap:variable name="General.changeset" />. The <code>validCheckSum</code> tag should contain the new checksum from the error message. For example:</p><pre xml:space="preserve"><code class="language-xml">&lt;changeSet id="1" author="example"&gt;
    &lt;validCheckSum&gt;8:b4fd16a20425fe377b00d81df722d604&lt;/validCheckSum&gt;
    &lt;addColumn tableName="my_table"&gt;
        &lt;column name="my_column" type="BIGINT"/&gt;
    &lt;/addColumn&gt;
&lt;/changeSet&gt;</code></pre>
        <h3><code>clear-checksums</code>
        </h3>
        <p>The third option is to use the <MadCap:xref href="../../commands/maintenance/clear-checksums.htm">clear-checksums</MadCap:xref> command to resolve the checksum error. <b>However, it will clear the entire <code>MD5SUM</code> column of checksums in your <MadCap:variable name="General.databasechangelog" /> table.</b> When you run the command, <MadCap:variable name="General.Liquibase" /> calculates new checksums for all deployed <MadCap:variable name="General.changeset" />s, and deploys any undeployed <MadCap:variable name="General.changeset" />s. In the CLI, enter:</p><pre xml:space="preserve"><code class="language-text">liquibase clear-checksums</code></pre>
        <h2><code>runOnChange</code>&#160;<MadCap:variable name="General.Param/Attribute" /></h2>
        <p>Checksums are also used in conjunction with the <code><MadCap:xref href="attributes/runonchange.htm">runOnChange</MadCap:xref></code>&#160;<MadCap:variable name="General.changeset" />&#160;<MadCap:variable name="General.Param/Attribute" />. There are times you may not want to add a new <MadCap:variable name="General.changeset" /> because you only need to know 
about the current version, but you want this change to be applied whenever it is updated. For example, you can do this with stored procedures.</p>
        <p>If you copy the entire 
text of the stored procedure to a new <MadCap:variable name="General.changeset" /> each time you make a change, you will not only end up with a very long <MadCap:variable name="General.changelog" />, but you will lose the merging and diffing 
power of your source control. Instead, put the text of the stored procedure in a <MadCap:variable name="General.changeset" /> with a <code>runOnChange="true"</code>&#160;<MadCap:variable name="General.Param/Attribute" />. The stored procedure will be re-created 
when there is a change to the text of it. For example:</p><pre><code class="language-xml">&lt;changeSet  author="your.name"  id="changeset01"  runOnChange="true" &gt;
    &lt;createProcedure&gt;
    . . .
    &lt;/createProcedure&gt;
&lt;/changeSet&gt;</code></pre>
        <h2>Related links</h2>
        <ul>
            <li>
                <MadCap:xref href="home.html">Changelog</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="changeset.html">Changeset</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="attributes/home.htm">Changelog [%=General.Param/Attr/Uppercased%]s</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="../../commands/maintenance/calculate-checksum.html">calculate-checksum</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="../../commands/maintenance/clear-checksums.htm">clear-checksums</MadCap:xref>
            </li>
        </ul>
    </body>
</html>