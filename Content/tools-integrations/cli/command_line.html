<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body>
        <h1 id="liquibase-command-line">Liquibase Command Line</h1>
        <p>Liquibase can be run from the command line by running:</p>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">liquibase [global options] [command] [command parameters]</code></pre>
        </figure>
        <p>The command line migrator works well when you want to do migrations on demand, but don’t have Ant or Maven available such as on servers. 
The command line migrator also gives you more control over the process than the <a href="servlet_listener.html">servlet listener</a>, <a href="ant/index.html">Ant</a>, 
or <a href="maven/index.html">Maven</a> do, allowing you to run maintenance commands like outputting SQL and listing/releasing database changelog locks.</p>
        <p>Any values found after the command on the command line invocation will be considered a command parameter. The command line processor will 
validate whether the command line parameters are allowed for the current command. If the current command does not allow command line 
parameters or the parameter appears to be an incorrect format, then an error message of ‘unexpected command parameter’ will be logged 
and the execution will terminate.</p>
        <p>The command line migrator also allows you to:</p>
        <ul>
            <li><a href="rollback.html">perform rollback operations and generate rollback scripts</a>
            </li>
            <li><a href="diff.html">generate “diffs”</a>
            </li>
            <li><a href="generating_changelogs.html">generate creation scripts from existing databases</a>
            </li>
            <li><a href="dbdoc.html">generate database change documentation</a>
            </li>
        </ul>
        <p>If you run the command line migrator without any arguments, you will get a help message listing these available commands:</p>
        <h2 id="database-update-commands">Database Update Commands</h2>
        <table>
            <tr>
                <th>Command</th>
                <th>Description</th>
            </tr>
            <tr>
                <td><a href="/documentation/update.html">update</a>
                </td>
                <td>Updates database to current version.</td>
            </tr>
            <tr>
                <td>updateCount &lt;value&gt;</td>
                <td>Applies the next &lt;value&gt; change sets.</td>
            </tr>
            <tr>
                <td><a href="/documentation/generate-sql-update-schemas.html">updateSQL</a>
                </td>
                <td>Writes SQL to update database to current version to STDOUT.</td>
            </tr>
            <tr>
                <td>updateCountSQL &lt;value&gt;</td>
                <td>Writes SQL to apply the next &lt;value&gt; change sets to STDOUT.</td>
            </tr>
            <tr>
                <td>updateTestingRollback</td>
                <td>Updates the database, then rolls back changes before updating again.</td>
            </tr>
        </table>
        <h2 id="database-rollback-commands">Database Rollback Commands</h2>
        <table>
            <tr>
                <th>Command</th>
                <th>Description</th>
            </tr>
            <tr>
                <td><a href="/documentation/rollback.html">rollback &lt;tag&gt;</a>
                </td>
                <td>Rolls back the database to the state it was in when the tag was applied.</td>
            </tr>
            <tr>
                <td>rollbackToDate &lt;date/time&gt;</td>
                <td>Rolls back the database to the state it was in at the given date/time.</td>
            </tr>
            <tr>
                <td>rollbackCount &lt;value&gt;</td>
                <td>Rolls back the last &lt;value&gt; change sets.</td>
            </tr>
            <tr>
                <td>rollbackSQL &lt;tag&gt;</td>
                <td>Writes SQL to roll back the database to the state it was in when the tag was applied to STDOUT.</td>
            </tr>
            <tr>
                <td>rollbackToDateSQL &lt;date/time&gt;</td>
                <td>Writes SQL to roll back the database to the state it was in at the given date/time version to STDOUT.</td>
            </tr>
            <tr>
                <td>rollbackCountSQL &lt;value&gt;</td>
                <td>Writes SQL to roll back the last &lt;value&gt; change sets to STDOUT.</td>
            </tr>
            <tr>
                <td><a href="/documentation/rollbackonechangeset.html">rollbackOneChangeSet</a>
                </td>
                <td>Rolls back a single changeset without needing to roll back other already applied changesets. <span style="color: #fd8c00;">Liquibase Pro Feature</span></td>
            </tr>
            <tr>
                <td><a href="/documentation/rollbackonechangeset.html">rollbackOneChangeSetSQL</a>
                </td>
                <td>Writes SQL to roll back a single changest to STDOUT. <span style="color: #fd8c00;">Liquibase Pro Feature</span></td>
            </tr>
            <tr>
                <td>futureRollbackSQL</td>
                <td>Writes SQL to roll back the database to the current state after the changes in the changeslog have been applied.</td>
            </tr>
            <tr>
                <td>updateTestingRollback</td>
                <td>Updates the database, then rolls back changes before updating again.</td>
            </tr>
        </table>
        <h2 id="diff-commands">Diff Commands</h2>
        <table>
            <tr>
                <th>Command</th>
                <th>Description</th>
            </tr>
            <tr>
                <td><a href="/documentation/generating_changelogs.html">generateChangeLog</a>
                </td>
                <td>Generate a changelog from a database when adding Liquibase to a new project. 
Conceptually, does a diff of the current database to an empty database, creating a changelog that has all the changes needed to update an empty database.</td>
            </tr>
            <tr>
                <td><a href="/documentation/diff.html">diff [diff parameters]</a>
                </td>
                <td>Writes description of differences between two databases to standard out.</td>
            </tr>
            <tr>
                <td><a href="/documentation/diffChangeLog.html">diffChangeLog [diff parameters]</a>
                </td>
                <td>Adds any differences between the databases specified to a changelog. 
Can append in any of the supported changelog formats.</td>
            </tr>
        </table>
        <h2 id="documentation-commands">Documentation Commands</h2>
        <table>
            <tr>
                <th>Command</th>
                <th>Description</th>
            </tr>
            <tr>
                <td><a href="/documentation/dbdoc.html">dbDoc &lt;outputDirectory&gt;</a>
                </td>
                <td>Generates Javadoc-like documentation based on current database and change log.</td>
            </tr>
        </table>
        <h2 id="maintenance-commands">Maintenance Commands</h2>
        <table>
            <tr>
                <th>Command</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>changelogSync</td>
                <td>Mark all changes as executed in the database.</td>
            </tr>
            <tr>
                <td>changelogSyncSQL</td>
                <td>Writes SQL to mark all changes as executed in the database to STDOUT.</td>
            </tr>
            <tr>
                <td>clearCheckSums</td>
                <td>Removes current checksums from database. On next update changesets that
 have already been deployed will have their checksums recomputed, and changesets that have not been deployed
 will be deployed.</td>
            </tr>
            <tr>
                <td>dropAll</td>
                <td>Drops all database objects owned by the user. DANGEROUS!</td>
            </tr>
            <tr>
                <td>listLocks</td>
                <td>Lists who currently has locks on the database changelog.</td>
            </tr>
            <tr>
                <td>markNextChangeSetRan</td>
                <td>Mark the next change set as executed in the database.</td>
            </tr>
            <tr>
                <td>releaseLocks</td>
                <td>Releases all locks on the database changelog.</td>
            </tr>
            <tr>
                <td>status</td>
                <td>Outputs count (list if --verbose) of unrun change sets.</td>
            </tr>
            <tr>
                <td><a href="/documentation/snapshot.html">snapshot</a>
                </td>
                <td>Gathers the current database schema and displays that information to STDOUT. With options, can save
the schema in JSON format, and that JSON snapshot can serve as a comparison database.</td>
            </tr>
            <tr>
                <td>tag &lt;tag&gt;</td>
                <td>"Tags" the current database state for future rollback.</td>
            </tr>
            <tr>
                <td>tagExists &lt;tag&gt;</td>
                <td>Checks whether the given tag already exists.</td>
            </tr>
            <tr>
                <td>validate</td>
                <td>Checks the changelog for errors.</td>
            </tr>
        </table>
        <h2 id="required-parameters-for-most-commands">Required Parameters for most commands</h2>
        <table>
            <tr>
                <th>Option</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>--changeLogFile=&lt;path and filename&gt;</td>
                <td>The changelog file to use.</td>
            </tr>
            <tr>
                <td>--username=&lt;value&gt;</td>
                <td>Database username.</td>
            </tr>
            <tr>
                <td>--password=&lt;value&gt;</td>
                <td>Database password.</td>
            </tr>
            <tr>
                <td>--url=&lt;value&gt;</td>
                <td>Database JDBC URL.</td>
            </tr>
            <tr>
                <td>--driver=&lt;jdbc.driver.ClassName&gt;</td>
                <td>Database driver class name.</td>
            </tr>
        </table>
        <h2 id="optional-parameters">Optional Parameters</h2>
        <table>
            <tr>
                <th>Option</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>--classpath=&lt;value&gt;</td>
                <td>Classpath containing migration files and JDBC Driver. List multiple items using the standard 
 path separator for your platform, which is a colon (:) on Mac/Linux, and a semicolon (;) on Windows.</td>
            </tr>
            <tr>
                <td>--contexts=&lt;value&gt;</td>
                <td>changeSet <a href="/documentation/contexts.html">contexts</a> to execute.  </td>
            </tr>
            <tr>
                <td>--defaultSchemaName=&lt;schema&gt;</td>
                <td>Specifies the default schema to use for managed database objects and for Liquibase control tables.  </td>
            </tr>
            <tr>
                <td>--databaseClass=&lt;custom.DatabaseImpl&gt;</td>
                <td>Specifies a custom <a href="/javadoc/liquibase/database/Database.html">Database</a> implementation to use  </td>
            </tr>
            <tr>
                <td>--defaultsFile=&lt;/path/to/file&gt;</td>
                <td>File containing default option values. (default: ./liquibase.properties)  </td>
            </tr>
            <tr>
                <td>--includeSystemClasspath=&lt;true or false&gt;</td>
                <td>Include the system classpath in the Liquibase classpath. (default: true)  </td>
            </tr>
            <tr>
                <td>--promptForNonLocalDatabase=&lt;true or false&gt;</td>
                <td>Prompt if non-localhost databases. (default: false)  </td>
            </tr>
            <tr>
                <td>--currentDateTimeFunction=&lt;value&gt;</td>
                <td>Overrides current date time function used in SQL. Useful for unsupported databases.  </td>
            </tr>
            <tr>
                <td>--labels=&lt;value&gt;</td>
                <td>Filter the changelog using <a href="/documentation/labels.html">labels</a>.</td>
            </tr>
            <tr>
                <td>--logLevel=&lt;level&gt;</td>
                <td>Execution log level (debug, info, warning, severe, off).  </td>
            </tr>
            <tr>
                <td>--logFile=&lt;filename&gt;</td>
                <td>Rather than logging to console, send logging messages to a file.</td>
            </tr>
            <tr>
                <td>--liquibaseProLicenseKey=&lt;licenKey&gt;</td>
                <td>A Liquibase Pro license key (base64 encoded string) unlocks additional features.</td>
            </tr>
            <tr>
                <td>--help</td>
                <td>Output command line parameter help.</td>
            </tr>
            <tr>
                <td>--dataOutputDirectory</td>
                <td>Directory where insert statement csv files will be kept (required by generateChangeLog command).</td>
            </tr>
            <tr>
                <td>--propertyProviderClass=&lt;properties.ClassName&gt;</td>
                <td>Custom properties implementation to use</td>
            </tr>
            <tr>
                <td>--schemas=&lt;name1,name2&gt;</td>
                <td>A comma-separated list of database schemas from which to include objects when executing a command, such as snapshot, generatechangelog or diffchangelog. This flag is required when you are referencing multiple schemas in a command.</td>
            </tr>
        </table>
        <h2 id="required-diff-parameters">Required Diff Parameters</h2>
        <table>
            <tr>
                <th>Option</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>--referenceUsername=&lt;value&gt;</td>
                <td>Base Database username.  </td>
            </tr>
            <tr>
                <td>--referencePassword=&lt;value&gt;</td>
                <td>Base Database password.  </td>
            </tr>
            <tr>
                <td>--referenceUrl=&lt;value&gt;</td>
                <td>Base Database URL.  </td>
            </tr>
        </table>
        <h2 id="optional-diff-parameters">Optional Diff Parameters</h2>
        <table>
            <tr>
                <th>Option</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>--referenceDriver=&lt;jdbc.driver.ClassName&gt;</td>
                <td>Base Database driver class name.</td>
            </tr>
            <tr>
                <td>--referenceDefaultSchemaName=&lt;schema&gt;</td>
                <td>Base Database default schema name.</td>
            </tr>
        </table>
        <h2 id="changelog-properties"><em>changelog</em> Properties</h2>
        <table>
            <tr>
                <th>Option</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>-D&lt;property.name&gt;=&lt;property.value&gt;</td>
                <td>Pass a name/value pair for <a href="changelog_parameters.html">substitution of ${} blocks</a> in the changelogs.</td>
            </tr>
        </table>
        <h2 id="using-a-liquibaseproperties-file">Using a <code class="highlighter-rouge">liquibase.properties</code> file</h2>
        <p>If you do not want to always specify options on the command line, you can create a <a href="config_properties.html">properties file</a> that contains default values. By default, Liquibase will look for a file called <code class="highlighter-rouge">liquibase.properties</code> in the current working directory, but you can specify an alternate location with the <code class="highlighter-rouge">--defaultsFile</code> flag. If you have specified an option in a properties file and specify the same option on the command line, the value on the command line will override the properties file value.</p>
        <h2 id="examples">Examples</h2>
        <h3 id="standard-update-run">Standard Update Run</h3>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=\path\to\classes:jdbcdriver.jar \
      --changeLogFile=com/example/db.changelog.xml \
      --url="jdbc:oracle:thin:@localhost:1521:oracle" \
      --username=scott \
      --password=tiger \
      update</code></pre>
        </figure>
        <h3 id="run-update-pulling-changelogs-from-a-war-file">Run update pulling <em>changelogs</em> from a .WAR file</h3>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=website.war \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger \
      update</code></pre>
        </figure>
        <h3 id="run-update-pulling-changelogs-from-an-ear-file">Run update pulling <em>changelogs</em> from an .EAR file</h3>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">java -jar liquibase.jar \
      --driver=oracle.jdbc.OracleDriver \
      --classpath=application.ear \
      --changeLogFile=com/example/db.changelog.xml \
      --url=jdbc:oracle:thin:@localhost:1521:oracle \
      --username=scott \
      --password=tiger \
      update</code></pre>
        </figure>
        <h3 id="dont-execute-changesets-save-sql-to-tmpscriptsql">Don’t execute <em>changeSets</em>, save SQL to /tmp/script.sql</h3>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        updateSQL &gt; /tmp/script.sql</code></pre>
        </figure>
        <h3 id="list-locks-on-the-databasechangeloglock-table">List locks on the <code class="highlighter-rouge">DATABASECHANGELOGLOCK</code> table</h3>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">java -jar liquibase.jar \
        --driver=oracle.jdbc.OracleDriver \
        --classpath=jdbcdriver.jar \
        --url=jdbc:oracle:thin:@localhost:1521:oracle \
        --username=scott \
        --password=tiger \
        listLocks</code></pre>
        </figure>
        <h3 id="runs-liquibase-using-defaults-from-liquibaseproperties">Runs Liquibase using defaults from <code class="highlighter-rouge">./liquibase.properties</code></h3>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">java -jar liquibase.jar update</code></pre>
        </figure>
        <h4 id="liquibaseproperties"><code class="highlighter-rouge">liquibase.properties</code>
        </h4>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-properties" data-lang="properties"><span class="py">driver</span><span class="p">:</span>  <span class="s">oracle.jdbc.OracleDriver</span>  
<span class="py">classpath</span><span class="p">:</span>  <span class="s">jdbcdriver.jar</span>  
<span class="py">url</span><span class="p">:</span>  <span class="s">jdbc:oracle:thin:@localhost:1521:oracle</span>  
<span class="py">username</span><span class="p">:</span>  <span class="s">scott</span>  
<span class="py">password</span><span class="p">:</span>  <span class="s">tiger</span></code></pre>
        </figure>
        <h3 id="export-data-from-database">Export Data from Database</h3>
        <p>This will export the data from the targeted database and put it in a folder “data” in a file name specified with &lt;insert file name&gt;.</p>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">java -jar liquibase.jar --changeLogFile="./data/&lt;insert file name&gt; " --diffTypes="data" generateChangeLog</code></pre>
        </figure>
        <h3 id="update-passing-changelog-parameters">Update passing <em>changelog</em> parameters</h3>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">liquibase.bat update -Dengine=myisam</code></pre>
        </figure>
        <h1 id="unicode">Unicode</h1>
        <h3 id="mysql">MySQL</h3>
        <p>Add url parameters useUnicode=true and characterEncoding=UTF-8 to set character encoding to utf8.</p>
        <p><em>Since v5.1.3 Connector/J now auto-detects servers configured with character_set_server=utf8mb4 or treats the Java encoding utf-8 passed using characterEncoding=… as utf8mb4.</em>
        </p>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-bat" data-lang="bat">--url="jdbc:mysql://localhost/dbname?useUnicode=true&amp;characterEncoding=UTF-8</code></pre>
        </figure>
        <p>more information about <a href="http://dev.mysql.com/doc/connector-j/en/connector-j-reference-charsets.html">MySQL Connector J Using Character Sets and Unicode</a></p>
    </body>
</html>