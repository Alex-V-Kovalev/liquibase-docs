<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" >
    <head></head>
    <body>
        <h1 id="database-migrations-with-multiple-sql-files">Database Migrations with Multiple SQL Files</h1>
        <h2 id="step-1-create-an-sql-folder">Step 1: Create an SQL Folder</h2>
        <p>To complete a migration, you must create an SQL folder in your Liquibase project folder. The SQL folder is where you will place all your your SQL scripts that Liquibase uses to track, version, and deploy changes to your database.</p>
        <h2 id="step-2-create-or-generate-a-changelog">Step 2: Create or Generate a Changelog</h2>
        <p>To use SQL script files, you must also have a <a href="/documentation/databasechangelog.html">database changelog</a> file. While the SQL scripts define all of your database changes, Liquibase still requires the use of a changelog to tell it where your scripts are located. While you can use XML, JSON, YAML, or formatted SQL when creating a changelog, you must create an XML changelog to use multiple SQL Scripts.</p>
        <p><strong><u>Creating Changelog Files Manually</u></strong>
        </p>
        <ol>
            <li>Create a file in your Liquibase project directory called <code class="highlighter-rouge">myChangeLog.xml</code>.</li>
            <li>For this example, enter the following information into the <code class="highlighter-rouge">myChangeLog.xml</code> file.</li>
        </ol>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>  
<span class="nt">&lt;databaseChangeLog</span>  
    <span class="na">xmlns=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog"</span>  
    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>  
    <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog
            http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd"</span><span class="nt">&gt;</span>  
<span class="nt">&lt;/databaseChangeLog&gt;</span></code></pre>
        </figure>
        <p>When you have completed your work, save your file.</p>
        <p><strong><u>Generating Changelog Files</u></strong>
        </p>
        <p>If you have an existing database, you can generate a changelog file that reflects the current state of your database. 
For more information on how to generate a changelog, visit the <a href="/documentation/generating_changelogs.html">Liquibase Commands: generateChangelog</a> topic, and read the article about <a href="/documentation/existing_project.html">Adding Liquibase on an Existing Project</a>.</p>
        <h2 id="step-3-configure-your-changelog">Step 3: Configure your Changelog</h2>
        <p>To run SQL scripts, you must tell Liquibase where your SQL scripts are located. To configure your changelog, use the <code class="highlighter-rouge">includeAll</code> tag to point Liquibase to the correct folder.</p>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>  
<span class="nt">&lt;databaseChangeLog</span>  
    <span class="na">xmlns=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog"</span>  
    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>  
    <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog
            http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd"</span><span class="nt">&gt;</span>  
    <span class="nt">&lt;includeAll</span>  <span class="na">path=</span><span class="s">"sql"</span><span class="nt">/&gt;</span>  
<span class="nt">&lt;/databaseChangeLog&gt;</span></code></pre>
        </figure>
        <h2 id="step-4-add-an-sql-script-to-the-sql-folder">Step 4: Add an SQL Script to the SQL Folder</h2>
        <p>To add SQL scripts to your SQL folder:</p>
        <ol>
            <li>In your SQL folder, create a <code class="highlighter-rouge">.sql</code> file.</li>
            <li>For this example, enter the following information:</li>
        </ol>
        <figure class="highlight"><pre xml:space="preserve"><code class="language-sql" data-lang="sql"><span class="k">create</span>  <span class="k">table</span>  <span class="n">PERSON</span>  <span class="p">(</span>  
    <span class="n">ID</span>  <span class="n">int</span>  <span class="k">not</span>  <span class="k">null</span><span class="p">,</span>  
    <span class="n">FNAME</span>  <span class="n">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>  <span class="k">not</span>  <span class="k">null</span>  
<span class="p">);</span></code></pre>
        </figure>
        <p>When you have completed your work, save your file.</p>
        <h2 id="step-5-deploy-your-script">Step 5: Deploy your Script</h2>
        <p>Once you have created and configured your changelog, and have also added your SQL scripts, you are ready to deploy.</p>
        <p><strong><u>To Deploy your Script</u></strong>
        </p>
        <ol>
            <li>Open your command prompt or terminal.</li>
            <li>Run one of the following commands:
    <ul><li><strong>Linux/Unix/Mac:</strong>  <code class="highlighter-rouge">LB_HOME/liquibase update</code></li><li><strong>Windows:</strong>  <code class="highlighter-rouge">LB_HOME\liquibase.bat update</code></li></ul></li>
        </ol>
        <blockquote>
            <p><strong>Note:</strong> In place of <code class="highlighter-rouge">LB_HOME</code>, use the folder name where you extracted Liquibase.</p>
        </blockquote>
        <p>Your database should now contain a table called <strong>PERSON</strong>.</p>
        <h2 id="step-check-your-database">Step: Check your Database</h2>
        <p>To check your database:</p>
        <ol>
            <li>Open your command prompt or terminal.</li>
            <li>Navigate to the folder where you placed your driver jar.</li>
            <li>Run: <code class="highlighter-rouge">java -jar (driver-version.jar)</code></li>
        </ol>
        <blockquote>
            <p><strong>Note:</strong> Where (driver-version.jar) is listed, enter your driver name and version number.</p>
        </blockquote>
        <p><strong>Example</strong>  <code class="highlighter-rouge">java -jar h2-1.4.199.jar</code></p>
        <p>If you used a <code class="highlighter-rouge">liquibase.properties</code> file, enter the JDBC URL, User Name, and Password information. Notice that two tables were created:</p>
        <ul>
            <li>DATABASECHANGELOG</li>
            <li>DATABASECHANGELOGLOCK</li>
        </ul>
        <p>The DATABASECHANGELOG table contains a list of all the changes that have been run against the database. The DATABASECHANGELOGLOCK table is used to make sure two machines don’t attempt to modify the database at the same time.</p>
        <p>View the <a href="/documentation/databasechangelog_table.html">DATABASECHANGELOG Table</a> and <a href="/documentation/databasechangeloglock_table.html">DATABASECHANGELOGLOCK Table</a> topics for more information.</p>
        <h3 id="summary">Summary</h3>
        <p>In this tutorial we covered:</p>
        <ul>
            <li>Creating/Generating Changelogs</li>
            <li>Adding Changesets to your Changelog</li>
            <li>Running your Changelog</li>
            <li>Checking your Database</li>
        </ul>
    </body>
</html>