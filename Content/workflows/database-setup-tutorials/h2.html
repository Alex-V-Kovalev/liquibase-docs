<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:sourceDocument="C:\Users\Datical\Downloads\_site\documentation\tutorials\h2.html">
  <head>
    <title>Liquibase | H2 Tutorial | Liquibase Docs</title>
    <meta name="description" content="H2 Tutorial | Liquibase Docs" />

  </head>

  <body>

    <h1 id="h2-database-tutorial-for-windows">H2 Database Tutorial for Windows</h1>
<p>The purpose of this document is to guide you through the process of creating a new Liquibase project with H2 on a Windows machine.</p>

<p>In this tutorial, you will generate an example project and follow the instructions to apply and learn concepts associated with creating new Liquibase Projects with an H2 database.</p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>If you have not installed the latest version of Liquibase, navigate to <a href="https://download.liquibase.org/download">https://download.liquibase.org/download</a> to install the software application.</li>
  <li>Ensure the <code class="highlighter-rouge">liquibase.bat</code> file’s path is set to a location in the <code class="highlighter-rouge">PATH</code> System variable.</li>
  <li>Navigate to <a href="http://www.h2database.com/html/download.html">http://www.h2database.com/html/download.html</a> and download the jdbc driver jar file for H2 database.</li>
</ul>

<h2 id="tutorial">Tutorial</h2>
<p>To create a Liquibase project with an H2 database on your Windows machine:</p>

<ol>
  <li>Create a new project folder and name it <code class="highlighter-rouge">LiquibaseH2</code>.</li>
  <li>Place the jdbc H2 jar driver file in the <code class="highlighter-rouge">LiquibaseH2</code> project directory.</li>
  <li>In your <code class="highlighter-rouge">LiquibaseH2</code> folder, <strong>Right-click</strong> then select <strong>New</strong> &gt; <strong>Text Document</strong> to create an empty text file.</li>
  <li>Rename the text file to <code class="highlighter-rouge">myChangeLog.xml</code>.
    <blockquote>
      <p><strong>Note:</strong><![CDATA[ ]]> <![CDATA[ ]]><em>Changelog</em> files contain a sequence of <em>changeSets</em>, each of which make small changes to the structure of your database. Instead of creating an empty <em>changelog</em> file in step 2, you can also use an existing database to generate a <em>changelog</em>. For more information see the <a href="/documentation/databasechangelog.html">Database Changelog File</a> topic.</p>
    </blockquote>
  </li>
</ol>

<h3 id="step-one-update-your-changelog">Step One: Update your <em>Changelog</em></h3>
<p>In this tutorial, you will need to modify your <em>changelog</em> by adding a template.</p>

<p>To add this <em>changelog</em> template:</p>
<ol>
  <li>Open the <code class="highlighter-rouge">myChangeLog.xml</code> file.</li>
  <li>Update the <em>changelog</em> file with the following code snippet, then save your file:</li>
</ol>

<figure class="highlight"><pre xml:space="preserve"><code class="language-xml" data-lang="xml">  <span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><![CDATA[ ]]> 
  <span class="nt">&lt;databaseChangeLog</span><![CDATA[ ]]> 
    <span class="na">xmlns=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog"</span><![CDATA[ ]]> 
    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><![CDATA[ ]]> 
    <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd"</span><span class="nt">&gt;</span><![CDATA[ ]]> 
  <span class="nt">&lt;/databaseChangeLog&gt;</span></code></pre></figure>

<p><br /></p>

<h3 id="step-two-create-a-liquibaseproperties-file">Step Two: Create a <code class="highlighter-rouge">liquibase.properties</code> file</h3>
<p>Next we will create a <code class="highlighter-rouge">liquibase.properties</code> file. To create the file:</p>
<ol>
  <li>In your <code class="highlighter-rouge">LiquibaseH2</code> folder, <strong>Right-click</strong> and select <strong>New</strong> &gt; <strong>Text Document</strong> to create a new text file.</li>
  <li>Rename the text file to <code class="highlighter-rouge">liquibase.properties</code>.</li>
  <li>Edit the <code class="highlighter-rouge">liquibase.properties</code> file to add the following properties:</li>
</ol>

<figure class="highlight"><pre xml:space="preserve"><code class="language-properties" data-lang="properties">    <span class="py">changeLogFile</span><span class="p">:</span><![CDATA[ ]]> <![CDATA[ ]]><span class="s">myChangeLog.xml</span><![CDATA[ ]]> 
    <span class="py">url</span><span class="p">:</span><![CDATA[ ]]> <![CDATA[ ]]><span class="s">jdbc:h2:file:./h2tutorial</span><![CDATA[ ]]> 
    <span class="py">username</span><span class="p">:</span><![CDATA[ ]]> <![CDATA[ ]]><span class="s">admin</span><![CDATA[ ]]> 
    <span class="py">password</span><span class="p">:</span><![CDATA[ ]]> <![CDATA[ ]]><span class="s">password</span><![CDATA[ ]]> 
    <span class="py">classpath</span><span class="p">:</span><![CDATA[ ]]> <![CDATA[ ]]><span class="s">h2-1.4.200.jar</span></code></pre></figure>

<blockquote>
  <p><strong>Note:</strong> In this <code class="highlighter-rouge">liquibase.properties</code> file example, the driver jar file is <code class="highlighter-rouge">h2-1.4.200.jar</code> under the classpath: property. Please rename it to match the one that you have previously downloaded accordingly.</p>
</blockquote>

<h3 id="step-three-add-your-changesets">Step Three: Add your <em>ChangeSets</em></h3>
<p>Now we will manually add a <em>changeSet</em> to the <em>changelog</em> file. Remember, when adding <em>ChangeSets</em>, they are uniquely identified by <strong>author</strong> and <strong>id</strong> attributes. Liquibase attempts to execute each <em>changeSet</em> in a transaction that is committed at the end.</p>

<p>To add additional <em>changeSets</em>:</p>

<ol>
  <li>In the <code class="highlighter-rouge">myChangeLog.xml</code> file line 9 to 20 add a new <strong>department</strong> create table <em>changeSet</em> as follows:</li>
</ol>

<figure class="highlight"><pre xml:space="preserve"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><![CDATA[ ]]> 

<span class="nt">&lt;databaseChangeLog</span><![CDATA[ ]]> 
  <span class="na">xmlns=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog"</span><![CDATA[ ]]> 
  <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><![CDATA[ ]]> 
  <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd"</span><span class="nt">&gt;</span><![CDATA[ ]]> 

    <span class="nt">&lt;changeSet</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">id=</span><span class="s">"1"</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">author=</span><span class="s">"bob"</span><span class="nt">&gt;</span><![CDATA[ ]]> 
        <span class="nt">&lt;createTable</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">tableName=</span><span class="s">"department"</span><span class="nt">&gt;</span><![CDATA[ ]]> 
            <span class="nt">&lt;column</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">name=</span><span class="s">"id"</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">type=</span><span class="s">"int"</span><span class="nt">&gt;</span><![CDATA[ ]]> 
                <span class="nt">&lt;constraints</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">primaryKey=</span><span class="s">"true"</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">nullable=</span><span class="s">"false"</span><span class="nt">/&gt;</span><![CDATA[ ]]> 
            <span class="nt">&lt;/column&gt;</span><![CDATA[ ]]> 
            <span class="nt">&lt;column</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">name=</span><span class="s">"name"</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">type=</span><span class="s">"varchar(50)"</span><span class="nt">&gt;</span><![CDATA[ ]]> 
                <span class="nt">&lt;constraints</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">nullable=</span><span class="s">"false"</span><span class="nt">/&gt;</span><![CDATA[ ]]> 
            <span class="nt">&lt;/column&gt;</span><![CDATA[ ]]> 
            <span class="nt">&lt;column</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">name=</span><span class="s">"active"</span><![CDATA[ ]]> <![CDATA[ ]]><span class="na">type=</span><span class="s">"boolean"</span><![CDATA[ ]]> 
              <span class="na">defaultValueBoolean=</span><span class="s">"true"</span><span class="nt">/&gt;</span><![CDATA[ ]]> 
        <span class="nt">&lt;/createTable&gt;</span><![CDATA[ ]]> 
   <span class="nt">&lt;/changeSet&gt;</span><![CDATA[ ]]> 
<span class="nt">&lt;/databaseChangeLog&gt;</span></code></pre></figure>

<blockquote>
  <p><strong>Note:</strong> This create table <em>changeSet</em> is XML format. The corresponding SQL statement should look like the following:</p>
</blockquote>

<figure class="highlight"><pre xml:space="preserve"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span><![CDATA[ ]]> <![CDATA[ ]]><span class="k">TABLE</span><![CDATA[ ]]> <![CDATA[ ]]><span class="nv">"department"</span><![CDATA[ ]]> 
  <span class="p">(</span><span class="nv">"id"</span><![CDATA[ ]]> <![CDATA[ ]]><span class="n">number</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><![CDATA[ ]]> 
   <span class="nv">"name"</span><![CDATA[ ]]> <![CDATA[ ]]><span class="n">VARCHAR2</span><span class="p">(</span><span class="mi">50</span><![CDATA[ ]]> <![CDATA[ ]]><span class="n">BYTE</span><span class="p">),</span><![CDATA[ ]]> 
   <span class="nv">"active"</span><![CDATA[ ]]> <![CDATA[ ]]><span class="n">NUMBER</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><![CDATA[ ]]> <![CDATA[ ]]><span class="k">DEFAULT</span><![CDATA[ ]]> <![CDATA[ ]]><span class="mi">1</span><![CDATA[ ]]> 
  <span class="p">);</span></code></pre></figure>

<ol>
  <li>Open the command prompt. Navigate to the LiquibaseH2 directory.</li>
  <li>Run the following command: <code class="highlighter-rouge">liquibase update</code>.</li>
</ol>

<p>From a database UI Tool, for example: <strong>DBeaver</strong> check your database changes.</p>

<p>You should see a new “<strong>department</strong>” table added to the database.</p>

<h2 id="example-output">Example Output</h2>

<figure class="highlight"><pre xml:space="preserve"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><![CDATA[ ]]> <![CDATA[ ]]><span class="o">*</span><![CDATA[ ]]> <![CDATA[ ]]><span class="k">FROM</span><![CDATA[ ]]> <![CDATA[ ]]><span class="k">public</span><span class="p">.</span><span class="n">department</span><span class="p">;</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>NAME</th>
      <th>ACTIVE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NULL</td>
      <td>NULL</td>
      <td>NULL</td>
    </tr>
  </tbody>
</table>

<p>You should also see two more tables:</p>
<ul>
  <li><strong>DATABASECHANGELOG</strong> tracking table – This table keeps a record of all the <em>changeSets</em> that were deployed. This way, next time when you deploy again, the <em>changeSets</em> in the <em>changelog</em> will be compared with the DATABASECHANGELOG tracking table and only the new <em>changeSets</em> that were not found in the DATABASECHANGELOG will be deployed. You will notice that a new row was created in that table with the <em>changeSet</em> information we have just deployed.</li>
</ul>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>AUTHOR</th>
      <th>FILENAME</th>
      <th>DATEEXECUTED</th>
      <th>ORDEREXECUTED</th>
      <th>EXECTYPE</th>
      <th>MDSUM</th>
      <th>…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>bob</td>
      <td>dbchangelog.xml</td>
      <td><code class="highlighter-rouge">date&amp;time</code></td>
      <td>1</td>
      <td>EXECUTED</td>
      <td><code class="highlighter-rouge">checksumvalue</code></td>
      <td>…</td>
    </tr>
  </tbody>
</table>

<ul>
  <li><strong>DATABASECHANGELOGLOCK</strong> – This table is used internally by Liquibase to manage access to the <em>changelog</em> table during deployment.</li>
</ul>



  </body>
</html>